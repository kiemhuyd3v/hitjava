{"version":3,"sources":["assets\\TaiXiuDouble\\TaiXiuScript\\TaiXiu1\\TaiXiuMini.PopupThanhDu.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\nimport Configs from \"../../../Loading/src/Configs\";\nimport Http from \"../../../Loading/src/Http\";\nimport App from \"../../../Lobby/LobbyScript/Script/common/App\";\nimport Dialog from \"../../../Lobby/LobbyScript/Script/common/Dialog\";\nimport Utils from \"../../../Lobby/LobbyScript/Script/common/Utils\";\n\nconst { ccclass, property } = cc._decorator;\n\nnamespace taixiumini {\n\n    @ccclass\n    export class PopupThanhDu extends Dialog {\n\n        @property(cc.SpriteFrame)\n        sprTabNormal: cc.SpriteFrame = null;\n        @property(cc.SpriteFrame)\n        sprTabActive: cc.SpriteFrame = null;\n        @property(cc.Node)\n        tabs: cc.Node = null;\n        @property(cc.Node)\n        childTabs: cc.Node = null;\n        @property(cc.Node)\n        itemTemplate: cc.Node = null;\n        @property(cc.Label)\n        lblDate: cc.Label = null;\n\n        private selectedTab = 0;\n        private selectedChildTab = 0;\n        private date = new Date();\n\n        private items = new Array<cc.Node>();\n\n        start() {\n            for (let i = 0; i < this.tabs.childrenCount; i++) {\n                let tab = this.tabs.children[i];\n                tab.on(\"click\", () => {\n                    this.selectedTab = i;\n                    this.selectedChildTab = 0;\n                    this.date = new Date();\n                    this.updateTabSpriteFrame();\n                    this.loadData();\n                });\n            }\n\n            for (let i = 0; i < this.childTabs.childrenCount; i++) {\n                let tab = this.childTabs.children[i];\n                tab.on(\"click\", () => {\n                    this.selectedChildTab = i;\n                    this.updateTabSpriteFrame();\n                    this.loadData();\n                });\n            }\n        }\n\n        dismiss() {\n            super.dismiss();\n            for (let i = 0; i < this.items.length; i++) {\n                this.items[i].active = false;\n            }\n        }\n\n        show() {\n            super.show();\n            App.instance.showBgMiniGame(\"TaiXiu\");\n            for (let i = 0; i < this.items.length; i++) {\n                this.items[i].active = false;\n            }\n            if (this.itemTemplate != null) this.itemTemplate.active = false;\n        }\n\n        _onShowed() {\n            super._onShowed();\n            this.selectedTab = 0;\n            this.selectedChildTab = 0;\n            this.updateTabSpriteFrame();\n            this.loadData();\n        }\n\n        actNext() {\n            if (this.selectedTab === 0) {\n                this.date.setDate(this.date.getDate() + 1);\n            } else {\n                this.date.setMonth(this.date.getMonth() + 1);\n            }\n            this.loadData();\n        }\n\n        actPrev() {\n            if (this.selectedTab === 0) {\n                this.date.setDate(this.date.getDate() - 1);\n            } else {\n                this.date.setMonth(this.date.getMonth() - 1);\n            }\n            this.loadData();\n        }\n\n        private updateTabSpriteFrame() {\n            for (let i = 0; i < this.tabs.childrenCount; i++) {\n                let tab = this.tabs.children[i];\n                tab.getComponent(cc.Sprite).spriteFrame = this.selectedTab == i ? this.sprTabActive : this.sprTabNormal;\n            }\n            for (let i = 0; i < this.childTabs.childrenCount; i++) {\n                let tab = this.childTabs.children[i];\n                tab.getComponent(cc.Sprite).spriteFrame = this.selectedChildTab == i ? this.sprTabActive : this.sprTabNormal;\n            }\n        }\n\n        private loadData() {\n            App.instance.showLoading(true);\n\n            var typeTop = this.selectedChildTab === 0 ? 1 : 0;\n            var date = this.selectedTab === 0 ? Utils.dateToYYYYMMdd(this.date) : Utils.dateToYYYYMM(this.date);\n            this.lblDate.string = date;\n            var params = this.selectedTab === 0 ? { \"c\": 103, \"date\": date, \"type\": typeTop, \"txType\": 1 } : { \"c\": 103, \"month\": date, \"type\": typeTop, \"txType\": 1 };\n            Http.get(Configs.App.API, params, (err, res) => {\n                App.instance.showLoading(false);\n                if (err != null) return;\n                if (!res[\"success\"]) return;\n\n                if (this.items.length == 0) {\n                    for (var i = 0; i < 10; i++) {\n                        let item = cc.instantiate(this.itemTemplate);\n                        item.parent = this.itemTemplate.parent;\n                        this.items.push(item);\n                    }\n                    this.itemTemplate.destroy();\n                    this.itemTemplate = null;\n                }\n\n                for (let i = 0; i < this.items.length; i++) {\n                    let item = this.items[i];\n                    if (i < res[\"results\"].length) {\n                        let itemData = res[\"results\"][i];\n                        item.getChildByName(\"bg\").opacity = i % 2 == 0 ? 10 : 0;\n                        item.getChildByName(\"no\").getComponent(cc.Label).string = (i + 1).toString();\n                        item.getChildByName(\"account\").getComponent(cc.Label).string = itemData[\"username\"];\n                        item.getChildByName(\"count\").getComponent(cc.Label).string = Utils.formatNumber(itemData[\"number\"]);\n                        item.getChildByName(\"winlose\").getComponent(cc.Label).string = Utils.formatNumber(itemData[\"totalMoney\"]);\n                        item.getChildByName(\"session\").getComponent(cc.Label).string = \"#\" + itemData[\"referenceId\"];\n                        item.getChildByName(\"award\").getComponent(cc.Label).string = itemData[\"prize\"];\n                        item.active = true;\n                    } else {\n                        item.active = false;\n                    }\n                }\n            });\n        }\n    }\n}\nexport default taixiumini.PopupThanhDu;\n"]}