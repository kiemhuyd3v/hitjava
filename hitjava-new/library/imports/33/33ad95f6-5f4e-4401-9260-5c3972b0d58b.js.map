{"version":3,"sources":["assets\\Lobby\\LobbyScript\\PopupEvent.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Configs from \"../../Loading/src/Configs\";\nimport { Global } from \"../../Loading/src/Global\";\nimport Http from \"../../Loading/src/Http\";\nimport App from \"./Script/common/App\";\nimport BroadcastReceiver from \"./Script/common/BroadcastReceiver\";\nimport Dialog from \"./Script/common/Dialog\";\nimport Utils from \"./Script/common/Utils\";\n\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class PopupEvent extends Dialog {\n\n    // LIFE-CYCLE CALLBACKS:\n    @property(sp.Skeleton)\n    animLixi: sp.Skeleton = null\n    dataEvent: any = null;\n    @property([cc.Node])\n    listItem: cc.Node[] = [];\n    @property(cc.Node)\n    nodeResult: cc.Node = null\n    @property(cc.Node)\n    nodeRule: cc.Node = null\n    @property(cc.Node)\n    nodeItemContainer: cc.Node = null\n    @property(cc.Label)\n    lbMoney: cc.Label = null\n    @property(sp.Skeleton)\n    animResult: sp.Skeleton = null\n\n    type: number = 0;\n\n    start() {\n        this.node.zIndex = cc.macro.MAX_ZINDEX;\n        this.bg.on(cc.Node.EventType.TOUCH_END, () => {\n            this.onClick();\n        })\n    }\n    showpPopup() {\n        //  cc.log('type=' + this.type)\n        super.show();\n        this.animLixi.node.active = false;\n        this.animLixi.node.opacity = 255;\n        this.nodeResult.active = false;\n        this.container.active = false;\n        this.nodeRule.active = false;\n        if (this.type == 0) {\n            this.container.active = true;\n            this.nodeItemContainer.active = false;\n            this.nodeRule.active = true;\n        } else {\n            this.container.active = false;\n            this.animLixi.node.active = true;\n        }\n    }\n    onClick() {\n        App.instance.showLoading(true);\n        cc.tween(this.animLixi.node).to(2.0, { opacity: 0 }).call(() => {\n            this.animLixi.node.active = false;\n        }).start();\n        this.bg.off(cc.Node.EventType.TOUCH_END);\n        //http://43.128.27.35:8081/api?c=2036&nn=BigBird&at=9350306a24c780af46509750ba4b50ab&ac=get\n        Http.get(Configs.App.API, { \"c\": 2036, \"nn\": Configs.Login.Nickname, \"at\": Configs.Login.AccessToken, \"ac\": \"receive\" }, (err, res) => {\n            App.instance.showLoading(false);\n            if (err) {\n                App.instance.ShowAlertDialog(App.instance.getTextLang(\"txt_unknown_error1\"));\n                this.dismiss();\n                return;\n            } else {\n                if (res.success) {\n                    this.container.active = true;\n                    this.nodeItemContainer.active = true;\n                    this.nodeRule.active = false;\n                    this.setInfo(res);\n                } else {\n                    this.animLixi.node.active = false;\n                    App.instance.ShowAlertDialog(res['message']);\n                    this.dismiss();\n                }\n            }\n        });\n    }\n    setInfo(data) {\n        let indexItem = Utils.randomRangeInt(0, 3);\n        let itemReceive = this.listItem[indexItem];\n        for (let i = 0; i < 3; i++) {\n            let item = this.listItem[i];\n            if (item != itemReceive) {\n                item.getChildByName(\"bgTien\").active = false;\n                item.getChildByName(\"icon\").color = cc.Color.GRAY;\n                item.getChildByName(\"btn_received\").active = false;\n                item.color = cc.Color.GRAY;\n            }\n        }\n        itemReceive.getChildByName(\"bgTien\").getComponentInChildren(cc.Label).string = Utils.formatNumber(data['data']);\n        itemReceive.getChildByName(\"bgTien\").active = false\n        itemReceive.getChildByName(\"btn_received\").on('click', () => {\n            this.lbMoney.string = Utils.formatNumber(data['data']);\n            Configs.Login.Coin += data['data'];\n            BroadcastReceiver.send(BroadcastReceiver.USER_UPDATE_COIN);\n            this.nodeResult.active = true;\n            this.animResult.setAnimation(0, \"start\", false);\n            this.animResult.setCompleteListener(() => {\n                this.animResult.setAnimation(0, \"idle\", true);\n            })\n            this.container.active = false;\n            this.scheduleOnce(() => {\n                this.dismiss();\n            }, 3.0);\n        })\n    }\n\n\n    // update (dt) {}\n}\n"]}