{"version":3,"sources":["assets\\ShootFish\\ShootFishScript\\ShootFish.Lobby.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Configs from \"../../Loading/src/Configs\";\nimport cmd from \"../../Lobby/LobbyScript/Lobby.Cmd\";\nimport App from \"../../Lobby/LobbyScript/Script/common/App\";\nimport BroadcastReceiver from \"../../Lobby/LobbyScript/Script/common/BroadcastReceiver\";\nimport Utils from \"../../Lobby/LobbyScript/Script/common/Utils\";\nimport MiniGameNetworkClient from \"../../Lobby/LobbyScript/Script/networks/MiniGameNetworkClient\";\nimport InPacket from \"../../Lobby/LobbyScript/Script/networks/Network.InPacket\";\nimport ShootFishNetworkClient from \"../../Lobby/LobbyScript/Script/networks/ShootFishNetworkClient\";\nimport Play from \"./ShootFish.Play\";\nimport PopupCoinTransfer from \"./ShootFish.PopupCoinTransfer\";\nimport Http from \"../../Loading/src/Http\";\nimport SPUtils from \"../../Lobby/LobbyScript/Script/common/SPUtils\";\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Lobby extends cc.Component {\n\n    public static instance: Lobby = null;\n\n    @property(cc.Node)\n    playNode: cc.Node = null;\n    @property(cc.Label)\n    lblBalance: cc.Label = null;\n    @property(PopupCoinTransfer)\n    popupCoinTransfer: PopupCoinTransfer = null;\n\n    private play: Play = null;\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        Lobby.instance = this;\n\n        this.play = this.playNode.getComponent(Play);\n        this.play.node.active = false;\n\n        this.lblBalance.string = Utils.formatNumber(Configs.Login.CoinFish);\n\n        BroadcastReceiver.register(BroadcastReceiver.USER_UPDATE_COIN, () => {\n            this.lblBalance.string = Utils.formatNumber(Configs.Login.CoinFish);\n        }, this);\n\n        ShootFishNetworkClient.getInstance().checkConnect((isLogined) => {\n            if (!isLogined) {\n                App.instance.alertDialog.showMsgWithOnDismissed(\"Đăng nhập thất bại, vui lòng thử lại.\", () => {\n                    this.actBack();\n                });\n                return;\n            }\n            Play.SERVER_CONFIG = Configs.Login.FishConfigs;\n            BroadcastReceiver.send(BroadcastReceiver.USER_UPDATE_COIN);\n\n            if (this && this.node && this.node.parent) {\n                if (Configs.Login.CoinFish <= 0) {\n                    App.instance.confirmDialog.show3(\"Tiền trong Bắn Cá của bạn đã hết, bạn có muốn chuyển tiền vào không?\", \"Có\", (isConfirm) => {\n                        if (isConfirm) {\n                            this.popupCoinTransfer.show();\n                        }\n                    });\n                }\n            }\n        });\n\n        ShootFishNetworkClient.getInstance().addOnClose(() => {\n            App.instance.showErrLoading(\"Mất kết nối, đang thử kết nối lại...\");\n        }, this);\n\n        MiniGameNetworkClient.getInstance().addListener((data) => {\n            let inPacket = new InPacket(data);\n            switch (inPacket.getCmdId()) {\n                case cmd.Code.GET_MONEY_USE: {\n                    let res = new cmd.ResGetMoneyUse(data);\n                    Configs.Login.Coin = res.moneyUse;\n                    BroadcastReceiver.send(BroadcastReceiver.USER_UPDATE_COIN);\n                    break;\n                }\n            }\n        }, this);\n    }\n\n    actBack() {\n        // NetworkClient.getInstance().close();\n        cc.audioEngine.stopAll();\n        App.instance.loadScene(\"Lobby\");\n    }\n\n    actHonors() {\n\n    }\n\n    actRoom1() {\n        this.show(false);\n        this.play.show(true, 1);\n    }\n\n    actRoom2() {\n        this.show(false);\n        this.play.show(true, 2);\n    }\n    actLogin(): void {\n        let username = Configs.Login.Username;\n        let password = Configs.Login.Password;\n\n        App.instance.showLoading(true);\n        Http.get(Configs.App.API, { c: 3, un: username, pw: md5(password) }, (err, res) => {\n            App.instance.showLoading(false);\n            if (err != null) {\n                //    App.instance.alertDialog.showMsg(\"Đăng nhập không thành công, vui lòng kiểm tra lại kết nối.\");\n                return;\n            }\n            // console.log(res);\n            switch (parseInt(res[\"errorCode\"])) {\n                case 0:\n                    //    console.log(\"Đăng nhập thành công.\");\n                    Configs.Login.AccessToken = res[\"accessToken\"];\n                    Configs.Login.SessionKey = res[\"sessionKey\"];\n                    Configs.Login.Username = username;\n                    Configs.Login.Password = password;\n                    Configs.Login.IsLogin = true;\n                    var userInfo = JSON.parse(base64.decode(Configs.Login.SessionKey));\n                    Configs.Login.Nickname = userInfo[\"nickname\"];\n                    Configs.Login.Avatar = userInfo[\"avatar\"];\n                    Configs.Login.Coin = userInfo[\"vinTotal\"];\n                    Configs.Login.LuckyWheel = userInfo[\"luckyRotate\"];\n                    Configs.Login.IpAddress = userInfo[\"ipAddress\"];\n                    Configs.Login.CreateTime = userInfo[\"createTime\"];\n                    Configs.Login.Birthday = userInfo[\"birthday\"];\n                    Configs.Login.Birthday = userInfo[\"birthday\"];\n                    Configs.Login.VipPoint = userInfo[\"vippoint\"];\n                    Configs.Login.VipPointSave = userInfo[\"vippointSave\"];\n\n                    // MiniGameNetworkClient.getInstance().checkConnect();\n                    //    MiniGameNetworkClient.getInstance().sendCheck(new cmd.ReqSubcribeJackpots());\n                    //    SlotNetworkClient.getInstance().sendCheck(new cmd.ReqSubcribeHallSlot());\n                    //    ShootFishNetworkClient.getInstance().checkConnect(() => {\n                    //        BroadcastReceiver.send(BroadcastReceiver.USER_UPDATE_COIN);\n                    //    });\n\n                    //     this.panelNotLogin.active = false;\n                    //    this.panelLogined.active = true;\n\n                    SPUtils.setUserName(Configs.Login.Username);\n                    SPUtils.setUserPass(Configs.Login.Password);\n\n                    App.instance.buttonMiniGame.show();\n                    //     this.getMailNotRead();\n\n                    BroadcastReceiver.send(BroadcastReceiver.USER_INFO_UPDATED);\n\n                    /* switch (VersionConfig.CPName) {\n                        default:\n                            this.popupBoomTan.show();\n                            break;\n                    } */\n                    break;\n                case 1007:\n                    App.instance.alertDialog.showMsg(\"Thông tin đăng nhập không hợp lệ.\");\n                    break;\n                case 2001:\n                    this.popupUpdateNickname.show2(username, password);\n                    break;\n                default:\n                    App.instance.alertDialog.showMsg(\"Đăng nhập không thành công vui lòng thử lại sau.\");\n                    break;\n            }\n        });\n    }\n    actRoom3() {\n        this.show(false);\n        this.play.show(true, 3);\n    }\n\n    public show(isShow: boolean) {\n        this.node.active = isShow;\n        BroadcastReceiver.send(BroadcastReceiver.USER_UPDATE_COIN);\n    }\n}\n"]}