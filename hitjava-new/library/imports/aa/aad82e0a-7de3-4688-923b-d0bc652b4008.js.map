{"version":3,"sources":["assets\\XocDia\\XocDiaScript\\XocDia.XocDiaController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\nimport Lobby from \"./XocDia.Lobby\";\nimport Play from \"./XocDia.Play\";\nimport XocDiaNetworkClient from \"./XocDia.XocDiaNetworkClient\";\n\nimport Configs from \"../../Loading/src/Configs\";\nimport App from \"../../Lobby/LobbyScript/Script/common/App\";\nimport InPacket from \"../../Lobby/LobbyScript/Script/networks/Network.InPacket\";\nimport cmdNetwork from \"../../Lobby/LobbyScript/Script/networks/Network.Cmd\";\nimport SPUtils from \"../../Lobby/LobbyScript/Script/common/SPUtils\";\nimport AudioManager from \"../../Lobby/LobbyScript/Script/common/Common.AudioManager\";\nenum audio_clip {\n    BG = 0,\n    LOSE = 1,\n    WIN = 2,\n    START_GAME = 3,\n    XOC_DIA = 4,\n    CHIP = 5\n}\nconst { ccclass, property } = cc._decorator;\n@ccclass(\"XocDia.SoundManager\")\nexport class SoundManager {\n    @property(cc.AudioSource)\n    bgMusic: cc.AudioSource = null;\n\n    @property(cc.AudioSource)\n    effSound: cc.AudioSource = null;\n\n    @property([cc.AudioClip])\n    listAudio: cc.AudioClip[] = [];\n    playBgMusic() {\n        if (SPUtils.getMusicVolumn() > 0) {\n            this.bgMusic.clip = this.listAudio[audio_clip.BG];\n            this.bgMusic.play();\n        }\n    }\n    playAudioEffect(indexAudio) {\n        if (SPUtils.getSoundVolumn() > 0) {\n            cc.audioEngine.play(this.listAudio[indexAudio], false, 1);\n        }\n    }\n    stopBgMusic() {\n        this.bgMusic.stop();\n    }\n}\n@ccclass\nexport default class XocDiaController extends cc.Component {\n\n    public static instance: XocDiaController = null;\n\n    @property(cc.Node)\n    noteLobby: cc.Node = null;\n    @property(cc.Node)\n    nodePlay: cc.Node = null;\n    @property(SoundManager)\n    soundManager: SoundManager = null;\n\n    public lobby: Lobby = null;\n    public play: Play = null;\n\n    onLoad() {\n        XocDiaController.instance = this;\n        this.lobby = this.noteLobby.getComponent(Lobby);\n    }\n\n    start() {\n        this.lobby.init();\n        // this.play.init();\n\n        this.lobby.node.active = true;\n        // this.play.node.active = false;\n\n        App.instance.showErrLoading(\"Đang kết nối tới server...\");\n        XocDiaNetworkClient.getInstance().addOnOpen(() => {\n            App.instance.showErrLoading(\"Đang đăng nhập...\");\n            XocDiaNetworkClient.getInstance().send(new cmdNetwork.SendLogin(Configs.Login.Nickname, Configs.Login.AccessToken));\n        }, this);\n        XocDiaNetworkClient.getInstance().addOnClose(() => {\n            //  cc.log(\"-----------XocDia close:\"+XocDiaNetworkClient.getInstance().isConnected());\n            XocDiaNetworkClient.getInstance().close();\n            App.instance.loadScene(\"Lobby\");\n        }, this);\n        XocDiaNetworkClient.getInstance().addListener((data) => {\n            let inpacket = new InPacket(data);\n            switch (inpacket.getCmdId()) {\n                case cmdNetwork.Code.LOGIN:\n                    App.instance.showLoading(false);\n                    //this.lobby.actRefesh();\n\t\t\t\t\tthis.lobby.actQuickPlay();\n                    break;\n            }\n        }, this);\n        //  cc.log(\"-----------XocDia start:\"+XocDiaNetworkClient.getInstance().isConnected());\n        if(XocDiaNetworkClient.getInstance().isConnected() == false){\n            XocDiaNetworkClient.getInstance().connect();\n        }\n        AudioManager.getInstance().playBackgroundMusic(this.soundManager.listAudio[audio_clip.BG]);\n    }\n\n    public showLobby() {\n        this.lobby.show();\n        this.play.node.active = false;\n    }\n    public showGamePlay(res) {\n        if (this.play == null) {\n            App.instance.showLoading(true);\n            cc.assetManager.loadBundle(\"XocDia\", (err, bundleGame) => {\n                bundleGame.load(\"res/prefabs/Play\", cc.Prefab, (finish, total) => {\n                    App.instance.showErrLoading(App.instance.getTextLang('txt_loading1'));\n                }, (err, prefab: cc.Prefab) => {\n                    this.play = cc.instantiate(prefab).getComponent(Play);\n                    this.play.node.parent = this.node;\n                    this.play.init();\n                    this.play.show(res);\n                    App.instance.showLoading(false);\n                    //  cc.log(\"init game player succecss!\");\n                    this.lobby.node.active = false;\n                });\n            })\n        } else {\n            this.lobby.node.active = false;\n            this.play.show(res);\n        }\n    }\n    public playAudioEffect(index) {\n        this.soundManager.playAudioEffect(index);\n    }\n}\n"]}