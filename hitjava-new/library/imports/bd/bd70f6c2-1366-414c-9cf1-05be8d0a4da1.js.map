{"version":3,"sources":["assets\\Lobby\\LobbyScript\\UIPopupMail.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Configs from \"../../Loading/src/Configs\";\nimport Http from \"../../Loading/src/Http\";\nimport App from \"./Script/common/App\";\nimport BroadcastReceiver from \"./Script/common/BroadcastReceiver\";\nimport Dialog from \"./Script/common/Dialog\";\nimport Utils from \"./Script/common/Utils\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class UIPopupMail extends Dialog {\n    @property(cc.Label)\n    lblPage: cc.Label = null;\n\n    @property(cc.Node)\n    content: cc.Node = null;\n    @property(cc.Node)\n    prefab: cc.Node = null;\n\n    @property(cc.Label)\n    txtTitle: cc.Label = null;\n\n    @property(cc.RichText)\n    txtContent: cc.RichText = null;\n\n    @property(cc.Label)\n    txtTime: cc.Label = null;\n\n    @property(cc.Label)\n    txtSender: cc.Label = null;\n\n    @property(cc.Node)\n    boxInfo: cc.Node = null;\n\n    @property(cc.Node)\n    boxEmpty: cc.Node = null;\n\n    @property(cc.Node)\n    boxHave: cc.Node = null;\n\n    private page: number = 1;\n    private maxPage: number = 1;\n    private items = new Array<cc.Node>();\n    private listMail = [];\n\n    start() {\n\n    }\n    _onShowed() {\n        super._onShowed();\n        this.page = 1;\n        this.maxPage = 1;\n        this.lblPage.string = this.page + \"/\" + this.maxPage;\n        this.loadData();\n    }\n\n    actNextPage() {\n        if (this.page < this.maxPage) {\n            this.page++;\n            this.lblPage.string = this.page + \"/\" + this.maxPage;\n            this.loadData();\n        }\n    }\n\n    actPrevPage() {\n        if (this.page > 1) {\n            this.page--;\n            this.lblPage.string = this.page + \"/\" + this.maxPage;\n            this.loadData();\n        }\n    }\n\n    show() {\n        super.show();\n        // this.loadData();\n    }\n\n    private loadData() {\n        App.instance.showLoading(true);\n        Http.get(Configs.App.API, { c: \"405\", nn: Configs.Login.Nickname, p: this.page }, (err, res) => {\n            App.instance.showLoading(false);\n            if (err != null) return;\n             //Utils.Log(\"UIPopupMail:\" + JSON.stringify(res));\n            if (res[\"success\"]) {\n                if (res[\"errorCode\"] == \"10001\") {\n                    this.boxEmpty.active = true;\n                    this.boxHave.active = false;\n                }\n                else {\n                    this.boxEmpty.active = false;\n                    this.boxHave.active = true;\n                    this.boxInfo.active = false;\n                    this.content.removeAllChildren();\n\n                    this.maxPage = res[\"totalPages\"];\n                    this.lblPage.string = this.page + \"/\" + this.maxPage;\n                    Configs.Login.ListMail = res[\"transactions\"];\n                    res['transactions'].sort((x, y) => {\n                        return x['status'] - y['status'];\n                    });\n                    BroadcastReceiver.send(BroadcastReceiver.ON_UPDATE_MAIL);\n                    for (let i = 0; i < res[\"transactions\"].length; i++) {\n                        let dataItem = res[\"transactions\"][i];\n                         //Utils.Log(\"Status==\" + dataItem['status']);\n                        var item = cc.instantiate(this.prefab);\n                        item.parent = this.content;\n                        item.getComponent(\"UIItemMail\").init(this, dataItem);\n                    }\n                }\n            }\n        });\n    }\n\n    private dataMailReading = null;\n    readMail(dataMail) {\n\n        this.dataMailReading = dataMail;\n        this.boxInfo.active = true;\n        this.txtTitle.string = App.instance.getTextLang('txt_mail_title') + dataMail.title + \" \" + dataMail.title;\n        this.txtContent.string =App.instance.getTextLang('txt_mail_content')+ dataMail.content;\n        this.txtTime.string =App.instance.getTextLang('txt_mail_time_send')+ dataMail.createTime;\n        this.txtSender.string = App.instance.getTextLang('txt_mail_from') + dataMail.author;\n    }\n\n    OpenURL() {\n        cc.sys.openURL(\"https://google.com\");\n    }\n    onBtnXoa() {\n        if (this.dataMailReading != null) {\n            App.instance.showLoading(true);\n            Http.get(Configs.App.API, { c: \"403\", mid: this.dataMailReading.mail_id }, (err, res) => {\n                App.instance.showLoading(false);\n                if (err != null) return;\n                if (res.success) {\n                    this.loadData();\n                }\n            });\n        }\n    }\n}\n"]}