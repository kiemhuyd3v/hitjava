{"version":3,"sources":["assets\\XocDia\\XocDiaScript\\XocDia.Lobby.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Configs from \"../../Loading/src/Configs\";\nimport XocDiaNetworkClient from \"./XocDia.XocDiaNetworkClient\";\nimport cmd from \"./XocDia.Cmd\";\n\nimport XocDiaController from \"./XocDia.XocDiaController\";\nimport App from \"../../Lobby/LobbyScript/Script/common/App\";\nimport BroadcastReceiver from \"../../Lobby/LobbyScript/Script/common/BroadcastReceiver\";\nimport Utils from \"../../Lobby/LobbyScript/Script/common/Utils\";\nimport InPacket from \"../../Lobby/LobbyScript/Script/networks/Network.InPacket\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Lobby extends cc.Component {\n\n    @property(cc.Prefab)\n    itemPrefab :cc.Prefab = null;\n    @property(cc.Sprite)\n    sprAvatar:cc.Sprite = null;\n    @property(cc.Label)\n    lblNickname: cc.Label = null;\n    @property(cc.Label)\n    lblCoin: cc.Label = null;\n\n    @property(cc.Node)\n    listItems: cc.Node = null;\n    \n    @property(cc.ScrollView)\n    scrRoom: cc.ScrollView = null;\n\n    private inited = false;\n    private dataRoom = [];\n    // onLoad () {}\n\n    start() {\n\n    }\n    private isSortRoom = false;\n    onBtnSortRoomId(){\n        if(this.isSortRoom == false){\n            if(this.dataRoom){\n                this.dataRoom.sort((x, y) => {\n                    return x.id - y.id;\n                })\n            }\n        }\n        else{\n            if(this.dataRoom){\n                this.dataRoom.sort((x, y) => {\n                    return y.id - x.id;\n                })\n            }\n        }\n        this.isSortRoom = !this.isSortRoom;\n        this.scrRoom.content.removeAllChildren();\n        for(var i=0;i<this.dataRoom.length;i++){\n            var item = cc.instantiate(this.itemPrefab);\n            item.active = true;\n            this.scrRoom.content.addChild(item);\n            item.getComponent(\"XocDia.Room\").init(this.dataRoom[i]);\n        }\n    }\n    private isSortMoney;\n    onBtnSortRoomMoney(){\n        //  cc.log(\"onBtnSortRoomMoney\");\n        if(this.isSortMoney == false){\n            if(this.dataRoom){\n                this.dataRoom.sort((x, y) => {\n                    return x.requiredMoney - y.requiredMoney;\n                })\n            }\n        }\n        else{\n            if(this.dataRoom){\n                this.dataRoom.sort((x, y) => {\n                    return y.requiredMoney - x.requiredMoney;\n                })\n            }\n        }\n        this.isSortMoney = !this.isSortMoney;\n        this.scrRoom.content.removeAllChildren();\n        for(var i=0;i<this.dataRoom.length;i++){\n            var item = cc.instantiate(this.itemPrefab);\n            item.active = true;\n            this.scrRoom.content.addChild(item);\n            item.getComponent(\"XocDia.Room\").init(this.dataRoom[i]);\n        }\n    }\n    public init() {\n        if (this.inited) return;\n        this.inited = true;\n        this.sprAvatar.spriteFrame = App.instance.getAvatarSpriteFrame(Configs.Login.Avatar);\n        this.lblNickname.string = Configs.Login.Nickname;\n        BroadcastReceiver.register(BroadcastReceiver.USER_UPDATE_COIN, () => {\n            if (!this.node.active) return;\n            this.lblCoin.string = Utils.formatNumber(Configs.Login.Coin);\n        }, this);\n        BroadcastReceiver.send(BroadcastReceiver.USER_UPDATE_COIN);\n\n        XocDiaNetworkClient.getInstance().addListener((data) => {\n            if (!this.node.active) return;\n            let inpacket = new InPacket(data);\n            switch (inpacket.getCmdId()) {\n                case cmd.Code.LOGIN:\n                    {\n                        XocDiaNetworkClient.getInstance().send(new cmd.SendReconnect());\n                    }\n                    break;\n                case cmd.Code.GETLISTROOM:\n                    {\n                        let res = new cmd.ReceiveGetListRoom(data);\n                        //  cc.log(\"GETLISTROOM:\" + JSON.stringify(res));\n                        //  cc.log(res);\n                        this.scrRoom.content.removeAllChildren();\n                        this.dataRoom = res.list;\n                        this.dataRoom.sort((x, y) => {\n                            return x.id - y.id;\n                        })\n                        for(var i=0;i<this.dataRoom.length;i++){\n                            var item = cc.instantiate(this.itemPrefab);\n                            item.active = true;\n                            this.scrRoom.content.addChild(item);\n                            item.getComponent(\"XocDia.Room\").init(this.dataRoom[i]);\n                        }\n                        // let cb = (item, itemData) => {\n                        //     item.getComponent(\"XocDia.Room\").init(itemData);\n                        //     item.active = true;\n                        // }\n                        // this.dataRoom = res.list;\n                        // this.dataRoom.sort((x, y) => {\n                        //     return x.moneyBet - y.moneyBet;\n                        // })\n                        // this.scrRoom.node.getComponent(\"ScrollViewControl\").setDataList(cb, this.dataRoom);\n                        \n                    }\n                    break;\n                case cmd.Code.JOIN_ROOM_FAIL:\n                    {\n                        App.instance.showLoading(false);\n                        let res = new cmd.ReceiveJoinRoomFail(data);\n                        //  cc.log(res);\n                        let msg = \"Lỗi \" + res.getError() + \", không xác định.\";\n                        switch (res.getError()) {\n                            case 1:\n                                msg = App.instance.getTextLang(\"txt_room_err1\")\n                                break;\n                            case 2:\n                                msg = App.instance.getTextLang(\"txt_room_err2\")\n                                break;\n                            case 3:\n                                msg = App.instance.getTextLang(\"txt_room_err3\")\n                                break;\n                            case 4:\n                                msg = App.instance.getTextLang(\"txt_room_err2\")\n                                break;\n                            case 5:\n                                msg = App.instance.getTextLang(\"txt_room_err5\")\n                                break;\n                            case 6:\n                                msg = App.instance.getTextLang(\"txt_room_err6\")\n                                break;\n                            case 7:\n                                msg = App.instance.getTextLang(\"txt_room_err2\")\n                                break;\n                            case 8:\n                                msg = App.instance.getTextLang(\"txt_room_err11\")\n                                break;\n                            case 9:\n                                msg = App.instance.getTextLang(\"txt_room_err9\")\n                                break;\n                            case 10:\n                                msg = App.instance.getTextLang(\"txt_room_err10\")\n                        }\n                        App.instance.alertDialog.showMsg(msg);\n                    }\n                    break;\n                case cmd.Code.JOIN_ROOM_SUCCESS:\n                    {\n                        App.instance.showLoading(false);\n                        let res = new cmd.ReceiveJoinRoomSuccess(data);\n                        XocDiaController.instance.showGamePlay(res);\n                    }\n                    break;\n                default:\n                    //  cc.log(\"--inpacket.getCmdId(): \" + inpacket.getCmdId());\n                    break;\n            }\n        }, this);\n\n    }\n\n    public show() {\n        this.node.active = true;\n        this.actRefesh();\n        BroadcastReceiver.send(BroadcastReceiver.USER_UPDATE_COIN);\n    }\n\n    public actQuickPlay() {\n        XocDiaNetworkClient.getInstance().send(new cmd.SendJoinRoomById(2);\n    }\n\n    public actRefesh() {\n        // for (let i = 0; i < this.listItems.childrenCount; i++) {\n        //     if (this.listItems.children[i] != this.itemTemplate) {\n        //         this.listItems.children[i].destroy();\n        //     }\n        // }\n        XocDiaNetworkClient.getInstance().send(new cmd.SendGetListRoom());\n    }\n\n    public actBack() {\n        XocDiaNetworkClient.getInstance().close();\n        App.instance.loadScene(\"Lobby\");\n    }\n\n    public actCreateTable() {\n        App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_room_err12'));\n    }\n\n    // update (dt) {}\n}\n"]}