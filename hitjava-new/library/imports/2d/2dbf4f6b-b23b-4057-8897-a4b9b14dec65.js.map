{"version":3,"sources":["assets\\TaiXiuDouble\\TaiXiuScript\\TaiXiu2\\TaiXiuMini2.PanelChat.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import cmd from \"./TaiXiuMini2.Cmd\";\nimport TaiXiuMini2Controller from \"./TaiXiuMini2.TaiXiuMiniController\";\nimport Configs from \"../../../Loading/src/Configs\";\nimport TX2NetworkClient from \"../../../Lobby/LobbyScript/Script/networks/TX2NetworkClient\";\n\nconst { ccclass, property } = cc._decorator;\n\nnamespace taixiumini {\n    @ccclass\n    export class PanelChat extends cc.Component {\n\n        @property(cc.Node)\n        itemChatTemplate: cc.Node = null;\n        @property(cc.ScrollView)\n        scrMessage: cc.ScrollView = null;\n        @property(cc.EditBox)\n        edbMessage: cc.EditBox = null;\n\n        start() {\n            this.itemChatTemplate.active = false;\n        }\n\n        show(isShow: boolean) {\n            this.node.active = isShow;\n            if (isShow) {\n                for (var i = 0; i < this.scrMessage.content.childrenCount; i++) {\n                    let node = this.scrMessage.content.children[i];\n                    node.active = false;\n                }\n                TX2NetworkClient.getInstance().send(new cmd.SendScribeChat());\n            } else {\n                TX2NetworkClient.getInstance().send(new cmd.SendUnScribeChat());\n            }\n        }\n\n        addMessage(nickname: string, message: string) {\n            let item: cc.Node = null;\n            for (var i = 0; i < this.scrMessage.content.childrenCount; i++) {\n                let node = this.scrMessage.content.children[i];\n                if (!node.active) {\n                    item = node;\n                    break;\n                }\n            }\n            if (item == null) {\n                if (this.scrMessage.content.childrenCount >= 50) {\n                    item = this.scrMessage.content.children[0];\n                } else {\n                    item = cc.instantiate(this.itemChatTemplate);\n                }\n            }\n            var zIndex = 0;\n            for (var i = 0; i < this.scrMessage.content.childrenCount; i++) {\n                let node = this.scrMessage.content.children[i];\n                if (node != item) {\n                    node.zIndex = zIndex++;\n                }\n            }\n            item.parent = this.scrMessage.content;\n            let lblNickname: cc.Label = item.getChildByName(\"lblNickname\").getComponent(cc.Label);\n            lblNickname.string = nickname;\n            lblNickname.node.color = nickname == Configs.Login.Nickname ? cc.Color.WHITE.fromHEX(\"#3DFF00\") : cc.Color.WHITE.fromHEX(\"#FFC200\");\n            item.getChildByName(\"lblMessage\").getComponent(cc.Label).string = message;\n            item.active = true;\n            item.zIndex = zIndex++;\n            this.scrollToBottom();\n        }\n\n        sendChat() {\n            let msg = this.edbMessage.string.trim();\n            if (msg.length == 0) {\n                return;\n            }\n            this.edbMessage.string = \"\";\n            TaiXiuMini2Controller.instance.sendChat(msg);\n        }\n\n        scrollToBottom() {\n            this.scrMessage.scrollToBottom(0.2);\n        }\n    }\n}\nexport default taixiumini.PanelChat;\n"]}