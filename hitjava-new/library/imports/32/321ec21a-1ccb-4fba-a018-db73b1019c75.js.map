{"version":3,"sources":["assets\\TaiXiuDouble\\TaiXiuScript\\TaiXiu1\\TaiXiuMini.PopupHistory.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Configs from \"../../../Loading/src/Configs\";\nimport Http from \"../../../Loading/src/Http\";\nimport App from \"../../../Lobby/LobbyScript/Script/common/App\";\nimport Dialog from \"../../../Lobby/LobbyScript/Script/common/Dialog\";\nimport Utils from \"../../../Lobby/LobbyScript/Script/common/Utils\";\nimport Tween from \"../../../Lobby/LobbyScript/Script/common/Tween\";\n\nconst { ccclass, property } = cc._decorator;\n\nnamespace taixiumini {\n    @ccclass\n    export class PopupHistory extends Dialog {\n\n        @property(cc.Label)\n        lblPage: cc.Label = null;\n\n        @property(cc.Node)\n        prefab: cc.Node = null;\n        @property(cc.ScrollView)\n        scroll: cc.ScrollView = null;\n\n        // @property([cc.BitmapFont])\n        // fontNumber: cc.BitmapFont[] = [];\n\n        private page: number = 1;\n        private maxPage: number = 1;\n        private items = new Array<cc.Node>();\n        private historyData = [];\n        private totalPageLoaded = 0;\n\n        onLoad() {\n\n        }\n\n        show() {\n            super.show();\n            App.instance.showBgMiniGame(\"TaiXiu\");\n            this.historyData = [];\n            this.totalPageLoaded = 0;\n\t\t\tcc.tween(this.node).to(0.5, { y: 0 }, { easing: cc.easing.cubicOut }).start();\n            for (let i = 0; i < this.items.length; i++) {\n                this.items[i].active = false;\n            }\n        }\n\n        dismiss() {\n            super.dismiss();\n\t\t\tcc.tween(this.node).to(0.5, { y: -100 }, { easing: cc.easing.sineOut }).start();\n            this.scroll.content.removeAllChildren();\n            for (let i = 0; i < this.items.length; i++) {\n                this.items[i].active = false;\n            }\n        }\n\t\t\n\n        _onShowed() {\n            super._onShowed();\n\n            this.page = 1;\n            this.maxPage = 1;\n            this.lblPage.string = this.page + \"/\" + this.maxPage;\n            this.loadData();\n        }\n\n        actNextPage() {\n            if (this.page < this.maxPage) {\n                this.page++;\n                this.lblPage.string = this.page + \"/\" + this.maxPage;\n                this.loadData();\n            }\n        }\n\n        actPrevPage() {\n            if (this.page > 1) {\n                this.page--;\n                this.lblPage.string = this.page + \"/\" + this.maxPage;\n                this.loadData();\n            }\n        }\n\n        private loadData(isReloadScr = true) {\n            App.instance.showLoading(true);\n            Http.get(Configs.App.API, { \"c\": 100, \"p\": this.page, \"un\": Configs.Login.Nickname, \"mt\": Configs.App.MONEY_TYPE, \"txType\": 1 }, (err, res) => {\n                App.instance.showLoading(false);\n                if (err != null) return;\n                if (!res[\"success\"]) return;\n                //  cc.log(\"History :\" + this.page + \" : \" + JSON.stringify(res));\n                this.totalPageLoaded++;\n                this.maxPage = res[\"totalPages\"];\n                this.lblPage.string = this.page + \"/\" + this.maxPage;\n                this.loadHistory(res[\"transactions\"]);\n            });\n        }\n        loadHistory(datahistory) {\n            //  cc.log(\"loadHistory:\", datahistory);\n            this.scroll.content.removeAllChildren();\n            for (var i = 0; i < datahistory.length; i++) {\n                var node = cc.instantiate(this.prefab);\n                node.parent = this.scroll.content;\n                this.setItemData(node, datahistory[i]);\n            }\n        }\n        setItemData(item, itemData) {\n            let index = itemData['index']\n            item.getChildByName(\"bg\").opacity = index % 2 == 0 ? 255 : 0;\n            item.getChildByName(\"lblSession\").getComponent(cc.Label).string = \"#\" + itemData[\"referenceId\"];\n            item.getChildByName(\"lblTime\").getComponent(cc.Label).string = itemData[\"timestamp\"].replace(\" \", \"\\n\");\n            item.getChildByName(\"lblBetDoor\").getComponent(cc.Label).string = itemData[\"betSide\"] == 1 ? \"TÀI\" : \"XỈU\";\n            item.getChildByName(\"lblResult\").getComponent(cc.Label).string = itemData[\"resultPhien\"];\n            item.getChildByName(\"lblBet\").getComponent(cc.Label).string = Utils.formatNumber(itemData[\"betValue\"]);\n            item.getChildByName(\"lblRefund\").getComponent(cc.Label).string = Utils.formatNumber(itemData[\"totalRefund\"]);\n            item.getChildByName(\"lblJackpot\").getComponent(cc.Label).string = Utils.formatNumber(itemData[\"totalJp\"]);\n            item.getChildByName(\"lblRefund\").getComponent(cc.Label).node.color = itemData['totalRefund'] > 0 ? new cc.Color(240, 191, 11) : new cc.Color(240, 48, 11);\n            item.getChildByName(\"lblWin\").getComponent(cc.Label).string = Utils.formatNumber(itemData[\"totalPrize\"]);\n            item.getChildByName(\"lblWin\").getComponent(cc.Label).node.color = itemData['totalPrize'] > 0 ? new cc.Color(240, 191, 11) : new cc.Color(240, 48, 11);\n            item.active = true;\n        }\n        onScrollEvent(scrollview, eventType, customEventData) {\n            if (eventType == cc.ScrollView.EventType.SCROLL_TO_BOTTOM) {\n                if (this.page < this.maxPage) {\n                    this.page++;\n                    this.loadData(false);\n                }\n            }\n        }\n    }\n\n}\nexport default taixiumini.PopupHistory;"]}