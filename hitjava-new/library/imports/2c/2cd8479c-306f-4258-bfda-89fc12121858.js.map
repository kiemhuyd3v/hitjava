{"version":3,"sources":["assets\\Loading\\src\\Http.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,qDAAgD;AAChD,iDAA4C;AAEtC,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAA;IAsGA,CAAC;IArGU,SAAI,GAAX,UAAY,GAAW,EAAE,MAAc,EAAE,UAAyC,EAAE,kBAA0B;QAA1B,mCAAA,EAAA,0BAA0B;QAC1G,8BAA8B;QAC9B,IAAI,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;QAC/B,IAAI,OAAO,GAAG,EAAE,CAAC;QACjB,IAAI,MAAM,KAAK,IAAI,EAAE;YACjB,IAAI,KAAK,GAAG,CAAC,CAAC;YACd,IAAI,YAAY,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC;YAC9C,KAAK,IAAI,GAAG,IAAI,MAAM,EAAE;gBACpB,IAAI,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;oBAC5B,OAAO,IAAI,GAAG,GAAG,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;oBACnC,IAAI,KAAK,GAAG,YAAY,GAAG,CAAC,EAAE;wBAC1B,OAAO,IAAI,GAAG,CAAC;qBAClB;iBACJ;gBACD,KAAK,EAAE,CAAC;aACX;SACJ;QAED,GAAG,CAAC,kBAAkB,GAAG;YACrB,IAAI,GAAG,CAAC,UAAU,KAAK,CAAC,EAAE;gBACtB,IAAI,GAAG,CAAC,MAAM,KAAK,GAAG,EAAE;oBACpB,IAAI,IAAI,GAAG,IAAI,CAAC;oBAChB,IAAI,CAAC,GAAG,IAAI,CAAC;oBACb,IAAI;wBACA,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;qBACvC;oBAAC,OAAO,EAAE,EAAE;wBACT,CAAC,GAAG,EAAE,CAAC;qBACV;oBACD,UAAU,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;iBACvB;qBAAM;oBACH,UAAU,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;iBAChC;aACJ;QACL,CAAC,CAAC;QACF,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;QAC5B,GAAG,CAAC,gBAAgB,CAAC,cAAc,EAAE,kBAAkB,CAAC,CAAC;QACzD,IAAI,kBAAkB,EAAE;YACpB,kCAAkC;YAClC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;SACpC;aAAM;YACH,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACrB;IAEL,CAAC;IAEM,QAAG,GAAV,UAAW,GAAW,EAAE,MAAc,EAAE,UAAyC;QAC7E,IAAI,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;QAC/B,IAAI,OAAO,GAAG,EAAE,CAAC;QACjB,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;QACtB,QAAQ,uBAAa,CAAC,MAAM,EAAE;YAC1B;gBACI,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;oBAC9B,MAAM,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;iBACtB;gBACD,MAAM,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;gBACnB,MAAM;SACb;QACD,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,IAAI,EAAE,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC,GAAG,CAAC,UAAU,EAAE;YACnD,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;SACvB;aAAM,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,IAAI,EAAE,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC,GAAG,CAAC,MAAM,EAAE;YACtD,MAAM,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;SACxB;aAAM,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,QAAQ,EAAE;YACzB,MAAM,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;SACxB;aAAM;YACH,MAAM,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;SAC1B;QACD,MAAM,CAAC,IAAI,CAAC,GAAG,iBAAO,CAAC,KAAK,CAAC,WAAW,CAAC;QACzC,IAAI,MAAM,KAAK,IAAI,EAAE;YACjB,IAAI,KAAK,GAAG,CAAC,CAAC;YACd,IAAI,YAAY,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC;YAC9C,KAAK,IAAI,GAAG,IAAI,MAAM,EAAE;gBACpB,IAAI,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;oBAC5B,OAAO,IAAI,GAAG,GAAG,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;oBACnC,IAAI,KAAK,EAAE,GAAG,YAAY,GAAG,CAAC,EAAE;wBAC5B,OAAO,IAAI,GAAG,CAAC;qBAClB;iBACJ;aACJ;SACJ;QAED,GAAG,CAAC,kBAAkB,GAAG;YACrB,IAAI,GAAG,CAAC,UAAU,KAAK,CAAC,EAAE;gBACtB,IAAI,GAAG,CAAC,MAAM,KAAK,GAAG,EAAE;oBACpB,IAAI,IAAI,GAAG,IAAI,CAAC;oBAChB,IAAI,CAAC,GAAG,IAAI,CAAC;oBACb,IAAI;wBACA,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;qBACvC;oBAAC,OAAO,EAAE,EAAE;wBACT,CAAC,GAAG,EAAE,CAAC;qBACV;oBACD,UAAU,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;iBACvB;qBAAM;oBACH,UAAU,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;iBAChC;aACJ;QACL,CAAC,CAAC;QACF,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,OAAO,CAAC;QAC/B,+BAA+B;QAC/B,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAC5B,GAAG,CAAC,IAAI,EAAE,CAAC;IACf,CAAC;IArGgB,IAAI;QADxB,OAAO;OACa,IAAI,CAsGxB;IAAD,WAAC;CAtGD,AAsGC,IAAA;kBAtGoB,IAAI","file":"","sourceRoot":"/","sourcesContent":["import Configs from \"../../Loading/src/Configs\";\nimport VersionConfig from \"./VersionConfig\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Http {\n    static post(url: string, params: object, onFinished: (err: any, json: any) => void, isSendNormalParams = false) {\n        // cc.log(\"url Post==\" + url);\n        var xhr = new XMLHttpRequest();\n        var _params = \"\";\n        if (params !== null) {\n            var count = 0;\n            var paramsLength = Object.keys(params).length;\n            for (var key in params) {\n                if (params.hasOwnProperty(key)) {\n                    _params += key + \"=\" + params[key];\n                    if (count < paramsLength - 1) {\n                        _params += \"&\";\n                    }\n                }\n                count++;\n            }\n        }\n\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4) {\n                if (xhr.status === 200) {\n                    var data = null;\n                    var e = null;\n                    try {\n                        data = JSON.parse(xhr.responseText);\n                    } catch (ex) {\n                        e = ex;\n                    }\n                    onFinished(e, data);\n                } else {\n                    onFinished(xhr.status, null);\n                }\n            }\n        };\n        xhr.open(\"POST\", url, true);\n        xhr.setRequestHeader(\"Content-type\", \"application/json\");\n        if (isSendNormalParams) {\n            // cc.log(\"Params Post==\", params)\n            xhr.send(JSON.stringify(params));\n        } else {\n            xhr.send(_params);\n        }\n\n    }\n\n    static get(url: string, params: object, onFinished: (err: any, json: any) => void) {\n        var xhr = new XMLHttpRequest();\n        var _params = \"\";\n        params = params || {};\n        switch (VersionConfig.CPName) {\n            default:\n                if (!params.hasOwnProperty(\"cp\")) {\n                    params[\"cp\"] = \"R\";\n                }\n                params[\"cl\"] = \"R\";\n                break;\n        }\n        if (cc.sys.isNative && cc.sys.os == cc.sys.OS_ANDROID) {\n            params[\"pf\"] = \"ad\";\n        } else if (cc.sys.isNative && cc.sys.os == cc.sys.OS_IOS) {\n            params[\"pf\"] = \"ios\";\n        } else if (!cc.sys.isNative) {\n            params[\"pf\"] = \"web\";\n        } else {\n            params[\"pf\"] = \"other\";\n        }\n        params[\"at\"] = Configs.Login.AccessToken;\n        if (params !== null) {\n            var count = 0;\n            var paramsLength = Object.keys(params).length;\n            for (var key in params) {\n                if (params.hasOwnProperty(key)) {\n                    _params += key + \"=\" + params[key];\n                    if (count++ < paramsLength - 1) {\n                        _params += \"&\";\n                    }\n                }\n            }\n        }\n\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4) {\n                if (xhr.status === 200) {\n                    var data = null;\n                    var e = null;\n                    try {\n                        data = JSON.parse(xhr.responseText);\n                    } catch (ex) {\n                        e = ex;\n                    }\n                    onFinished(e, data);\n                } else {\n                    onFinished(xhr.status, null);\n                }\n            }\n        };\n        var link = url + \"?\" + _params;\n        //  cc.log(\"GET LINK:\" + link);\n        xhr.open(\"GET\", link, true);\n        xhr.send();\n    }\n}\n"]}