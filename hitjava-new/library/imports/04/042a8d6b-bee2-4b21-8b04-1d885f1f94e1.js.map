{"version":3,"sources":["assets\\Loading\\src\\BundleControl.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Configs from \"./Configs\";\nimport { Global } from \"./Global\";\n\nexport default class BundleControl {\n    static serverVersion: any = {};\n\n    static init(data) {\n        this.serverVersion = data;\n        // let dataTest = '{ \"BaCay\": { \"hash\": \"6c91c\", \"url\": \"https://FANVIN.wIN/assets/BaCay\" }, \"BackupRes\": { \"hash\": \"59f9e\", \"url\": \"https://FANVIN.wIN/assets/BackupRes\" }, \"BaiCao\": { \"hash\": \"745af\", \"url\": \"https://FANVIN.wIN/assets/BaiCao\" }, \"BauCua\": { \"hash\": \"006b1\", \"url\": \"https://FANVIN.wIN/assets/BauCua\" }, \"CaoThap\": { \"hash\": \"74b61\", \"url\": \"https://FANVIN.wIN/assets/CaoThap\" }, \"internal\": { \"hash\": \"604e0\", \"url\": \"https://FANVIN.wIN/assets/internal\" }, \"Lieng\": { \"hash\": \"e4c86\", \"url\": \"https://FANVIN.wIN/assets/Lieng\" }, \"Lobby\": { \"hash\": \"f6fed\", \"url\": \"https://FANVIN.wIN/assets/Lobby\" }, \"Loto\": { \"hash\": \"83290\", \"url\": \"https://FANVIN.wIN/assets/Loto\" }, \"main\": { \"hash\": \"aa574\", \"url\": \"https://FANVIN.wIN/assets/main\" }, \"MauBinh\": { \"hash\": \"9e18d\", \"url\": \"https://FANVIN.wIN/assets/MauBinh\" }, \"migration\": { \"hash\": \"205da\", \"url\": \"https://FANVIN.wIN/assets/migration\" }, \"MiniPoker\": { \"hash\": \"7ef87\", \"url\": \"https://FANVIN.wIN/assets/MiniPoker\" }, \"OanTuTi\": { \"hash\": \"dd67d\", \"url\": \"https://FANVIN.wIN/assets/OanTuTi\" }, \"Poker\": { \"hash\": \"bbcc5\", \"url\": \"https://FANVIN.wIN/assets/Poker\" }, \"resources\": { \"hash\": \"ce096\", \"url\": \"https://FANVIN.wIN/assets/resources\" }, \"Sam\": { \"hash\": \"8853d\", \"url\": \"https://FANVIN.wIN/assets/Sam\" }, \"ScriptCore\": { \"hash\": \"6659c\", \"url\": \"https://FANVIN.wIN/assets/ScriptCore\" }, \"ShootFish\": { \"hash\": \"f3fee\", \"url\": \"https://FANVIN.wIN/assets/ShootFish\" }, \"Slot1\": { \"hash\": \"5a22d\", \"url\": \"https://FANVIN.wIN/assets/Slot1\" }, \"Slot10\": { \"hash\": \"bdf81\", \"url\": \"https://FANVIN.wIN/assets/Slot10\" }, \"Slot2\": { \"hash\": \"ca374\", \"url\": \"https://FANVIN.wIN/assets/Slot2\" }, \"Slot3\": { \"hash\": \"86863\", \"url\": \"https://FANVIN.wIN/assets/Slot3\" }, \"Slot3x3\": { \"hash\": \"818af\", \"url\": \"https://FANVIN.wIN/assets/Slot3x3\" }, \"Slot4\": { \"hash\": \"c3590\", \"url\": \"https://FANVIN.wIN/assets/Slot4\" }, \"Slot5\": { \"hash\": \"cf326\", \"url\": \"https://FANVIN.wIN/assets/Slot5\" }, \"Slot7\": { \"hash\": \"c0473\", \"url\": \"https://FANVIN.wIN/assets/Slot7\" }, \"Slot8\": { \"hash\": \"deae4\", \"url\": \"https://FANVIN.wIN/assets/Slot8\" }, \"Slot9\": { \"hash\": \"11666\", \"url\": \"https://FANVIN.wIN/assets/Slot9\" }, \"TaiXiuDouble\": { \"hash\": \"f78ee\", \"url\": \"https://FANVIN.wIN/assets/TaiXiuDouble\" }, \"TienLen\": { \"hash\": \"050ad\", \"url\": \"https://FANVIN.wIN/assets/TienLen\" }, \"XiDach\": { \"hash\": \"c35d2\", \"url\": \"https://FANVIN.wIN/assets/XiDach\" }, \"XocDia\": { \"hash\": \"af76c\", \"url\": \"https://FANVIN.wIN/assets/XocDia\" }, \"FbConfig\": { \"isShowBtnFb\":false } }';\n        // this.serverVersion = JSON.parse(dataTest);\n    }\n\n    static loadSceneGame(bundleName, sceneName, callbackProgress, bundleCallback) {\n        this.loadBundle(bundleName, bundle => {\n            bundle.loadScene(sceneName, function (finish, total, item) {\n                callbackProgress(finish, total);\n            }, function (err1, scene) {\n                cc.director.preloadScene(sceneName, (c, t, item) => {\n                    callbackProgress(c, t);\n                }, (err, sceneAsset) => {\n                    cc.director.loadScene(sceneName);\n                    bundleCallback();\n                });\n            });\n        })\n    }\n\n    static loadPrefabGame(bundleName, prefabName, callbackProgress, bundleCallback) {\n        this.loadBundle(bundleName, bundle => {\n            bundle.load(prefabName, cc.Prefab, function (finish, total, item) {\n                callbackProgress(finish, total);\n            }, function (err1, prefab) {\n                bundleCallback(prefab, bundle);\n            });\n        })\n    }\n\n    static loadBundle(bundleName, bundleCallback) {\n        if (Configs.App.IS_LOCAL) {\n            var url = bundleName;\n            cc.assetManager.loadBundle(url, (err, bundle) => {\n                if (err != null) {\n                    // errorCallback(err);\n                    //  cc.log(\"Error Donwload bundle:\" + JSON.stringify(err));\n                    return;\n                }\n                bundleCallback(bundle);\n            });\n        } else {\n            var bundleVersion = this.serverVersion[bundleName];\n            var url = bundleName;\n            if (cc.sys.isNative) {\n                url = bundleVersion.url;\n            }\n            // url = \"http://192.168.100.5:8700/remote/\" + bundleName\n            cc.assetManager.loadBundle(url, { version: bundleVersion.hash }, (err, bundle) => {\n                // cc.assetManager.loadBundle(url, (err, bundle) => {\n                if (err != null) {\n                    // errorCallback(err);\n                    //  cc.log(\"Error Donwload bundle:\" + JSON.stringify(err));\n                    return;\n                }\n                bundleCallback(bundle);\n            });\n        }\n\n    }\n    static loadPrefabPopup(prefabPath, cb) {\n        Global.BundleLobby.load(prefabPath, (err, prefab) => {\n            if (err) {\n                //  cc.log(\"Err load prefab bundle:\", err);\n                return;\n            } else {\n                //  cc.log(\"loadPrefabPopup Success\");\n                cb(prefab);\n            }\n        });\n    }\n\n}"]}