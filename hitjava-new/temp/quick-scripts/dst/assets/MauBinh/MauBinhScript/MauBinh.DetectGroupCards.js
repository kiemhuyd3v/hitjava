
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/MauBinh/MauBinhScript/MauBinh.DetectGroupCards.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'f9b67tXcw5LPJl58XvdhaB8', 'MauBinh.DetectGroupCards');
// MauBinh/MauBinhScript/MauBinh.DetectGroupCards.ts

"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.maubinh = void 0;
var MauBinh_Cmd_1 = require("./MauBinh.Cmd");
var maubinh;
(function (maubinh) {
    var DetectGroupCards = /** @class */ (function () {
        function DetectGroupCards() {
            this.groupKind = -1;
            this.cardList = [];
            this.valueList = [];
        }
        DetectGroupCards.prototype.getGroupCardsInfo = function () {
            this.groupKind = this.getGroupKind();
            return this.groupKind;
        };
        DetectGroupCards.prototype.getGroupKind = function () {
            if (1 == this.cardList.length)
                return MauBinh_Cmd_1.default.Code.GROUP_MAU_THAU;
            if (3 == this.cardList.length) {
                if (this.isSamCo())
                    return MauBinh_Cmd_1.default.Code.GROUP_SAM_CO;
                if (this.isMotDoi())
                    return MauBinh_Cmd_1.default.Code.GROUP_MOT_DOI;
            }
            if (5 == this.cardList.length) {
                if (this.isThungPhaSanh())
                    return MauBinh_Cmd_1.default.Code.GROUP_THUNG_PHA_SANH;
                if (this.isTuQuy())
                    return MauBinh_Cmd_1.default.Code.GROUP_TU_QUY;
                if (this.isCuLu())
                    return MauBinh_Cmd_1.default.Code.GROUP_CU_LU;
                if (this.isThung())
                    return MauBinh_Cmd_1.default.Code.GROUP_THUNG;
                if (this.isSanh())
                    return MauBinh_Cmd_1.default.Code.GROUP_SANH;
                if (this.isSamCo())
                    return MauBinh_Cmd_1.default.Code.GROUP_SAM_CO;
                if (this.isThu())
                    return MauBinh_Cmd_1.default.Code.GROUP_THU;
                if (this.isMotDoi())
                    return MauBinh_Cmd_1.default.Code.GROUP_MOT_DOI;
            }
            this.valueList = [];
            for (var a = this.getSortedCardList(), b = this.cardList.length - 1; 0 <= b; b--)
                this.valueList.push(a[b].getNumber());
            return MauBinh_Cmd_1.default.Code.GROUP_MAU_THAU;
        };
        DetectGroupCards.prototype.getGroupKindLevel = function (a) {
            var b = MauBinh_Cmd_1.default.Code.LV_BINH_THUONG;
            !a || this.groupKind != MauBinh_Cmd_1.default.Code.GROUP_THUNG_PHA_SANH && this.groupKind != MauBinh_Cmd_1.default.Code.GROUP_SANH || (10 == this.valueList[0] ? b = MauBinh_Cmd_1.default.Code.LV_THUONG : 1 == this.valueList[0] && (b = MauBinh_Cmd_1.default.Code.LV_HA));
            return b;
        };
        DetectGroupCards.prototype.getSortedCardList = function () {
            var a = [];
            for (var b = 0; b < this.cardList.length; b++) {
                a.push(this.cardList[b]);
            }
            // return a.sort(function (a, c) { return c.getId() - a.getId(); });
            return a.sort(function (a, c) { return a.getId() - c.getId(); });
        };
        DetectGroupCards.prototype.sortCardList = function (isIncrease) {
            if (isIncrease) {
                this.cardList.sort(function (a, c) { return c - a; });
            }
            else {
                this.cardList.sort(function (a, c) { return a - c; });
            }
        };
        // Kinds
        DetectGroupCards.prototype.isThungPhaSanh = function () {
            if (5 != this.cardList.length)
                return !1;
            for (var a = this.getSortedCardList(), b = 1, c = 1; c < this.cardList.length; c++)
                a[c].getSuit() == a[c - 1].getSuit() && (a[c].getNumber() == a[c - 1].getNumber() + 1 || 2 == a[0].getNumber() && 14 == a[c].getNumber()) && b++;
            b == this.cardList.length && (this.valueList = [], 2 == a[0].getNumber() && 14 == a[a.length - 1].getNumber() ? this.valueList.push(1) : this.valueList.push(a[0].getNumber()));
            return b == this.cardList.length;
        };
        DetectGroupCards.prototype.isTuQuy = function () {
            if (5 != this.cardList.length)
                return !1;
            for (var a = 0; a < this.cardList.length; a++)
                for (var b = 1, c = 0; c < this.cardList.length; c++)
                    if (a != c && this.cardList[a].getNumber() == this.cardList[c].getNumber() && b++, 4 == b)
                        return this.valueList = [], this.valueList.push(this.cardList[a].getNumber()), !0;
            return !1;
        };
        DetectGroupCards.prototype.isCuLu = function () {
            if (5 != this.cardList.length)
                return !1;
            var a = this.getSortedCardList(), b = !1;
            a[0].getNumber() == a[1].getNumber() && (a[1].getNumber() == a[2].getNumber() && a[3].getNumber() == a[4].getNumber() && (b = !0, this.valueList = [], this.valueList.push(a[0].getNumber()), this.valueList.push(a[3].getNumber())), a[2].getNumber() ==
                a[3].getNumber() && a[3].getNumber() == a[4].getNumber() && (b = !0, this.valueList = [], this.valueList.push(a[2].getNumber()), this.valueList.push(a[0].getNumber())));
            return b;
        };
        DetectGroupCards.prototype.isThung = function () {
            var a = this.getSortedCardList();
            if (5 != this.cardList.length)
                return !1;
            for (var b = 1; b < this.cardList.length; b++)
                if (a[b].getSuit() != a[0].getSuit())
                    return !1;
            this.valueList = [];
            for (b = this.cardList.length - 1; 0 <= b; b--)
                this.valueList.push(a[b].getNumber());
            return !0;
        };
        DetectGroupCards.prototype.isSanh = function () {
            if (5 != this.cardList.length)
                return !1;
            for (var a = this.getSortedCardList(), b = 1, c = 1; c < this.cardList.length; c++)
                (a[c].getNumber() == a[c - 1].getNumber() + 1 || 2 == a[0].getNumber() && 14 == a[c].getNumber()) && b++;
            b == this.cardList.length && (this.valueList = [], 2 == a[0].getNumber() && 14 == a[a.length - 1].getNumber()
                ? this.valueList.push(1) : this.valueList.push(a[0].getNumber()));
            return b == this.cardList.length;
        };
        DetectGroupCards.prototype.isSamCo = function () {
            for (var a = 0; a < this.cardList.length; a++) {
                for (var b = 1, c = 0; c < this.cardList.length; c++)
                    a != c && this.cardList[a].getNumber() ==
                        this.cardList[c].getNumber() && b++;
                if (3 == b)
                    return this.valueList = [], this.valueList.push(this.cardList[a].getNumber()), !0;
            }
            return !1;
        };
        DetectGroupCards.prototype.isThu = function () {
            if (5 != this.cardList.length)
                return !1;
            for (var a = [], b = 0; b < this.cardList.length - 1; b++)
                if (-1 == a.indexOf(this.cardList[b].getNumber()))
                    for (var c = b + 1; c < this.cardList.length; c++)
                        if (this.cardList[b].getNumber() == this.cardList[c].getNumber()) {
                            a.push(this.cardList[b].getNumber());
                            break;
                        }
            if (2 == a.length) {
                this.valueList = [];
                this.valueList.push(Math.max(a[0], a[1]));
                this.valueList.push(Math.min(a[0], a[1]));
                for (b = 0; b < this.cardList.length; b++)
                    -1 == a.indexOf(this.cardList[b].getNumber()) && this.valueList.push(this.cardList[b].getNumber());
                return !0;
            }
            return !1;
        };
        DetectGroupCards.prototype.isMotDoi = function () {
            for (var a = [], b = 0; b < this.cardList.length - 1; b++)
                for (var c = b + 1; c < this.cardList.length; c++)
                    this.cardList[b].getNumber() == this.cardList[c].getNumber() && a.push(this.cardList[b].getNumber());
            if (1 == a.length) {
                this.valueList = [];
                this.valueList.push(a[0]);
                var d = this.getSortedCardList();
                for (b = this.cardList.length - 1; 0 <= b; b--)
                    d[b].getNumber() != a[0] && this.valueList.push(d[b].getNumber());
                return !0;
            }
            return !1;
        };
        DetectGroupCards.prototype.addCard = function (a) {
            this.cardList.push(a);
        };
        DetectGroupCards.prototype.removeCard = function (id) {
            for (var b = 0; b < this.cardList.length; b++)
                if (this.cardList[b] == id) {
                    this.cardList.splice(b, 1);
                    break;
                }
        };
        return DetectGroupCards;
    }());
    maubinh.DetectGroupCards = DetectGroupCards;
})(maubinh = exports.maubinh || (exports.maubinh = {}));
exports.default = maubinh.DetectGroupCards;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcTWF1QmluaFxcTWF1QmluaFNjcmlwdFxcTWF1QmluaC5EZXRlY3RHcm91cENhcmRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDZDQUFnQztBQUVoQyxJQUFpQixPQUFPLENBeUp2QjtBQXpKRCxXQUFpQixPQUFPO0lBQ3BCO1FBQUE7WUFDSSxjQUFTLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDZixhQUFRLEdBQUcsRUFBRSxDQUFDO1lBQ2QsY0FBUyxHQUFHLEVBQUUsQ0FBQztRQW9KbkIsQ0FBQztRQWxKRyw0Q0FBaUIsR0FBakI7WUFDSSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztZQUNyQyxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDMUIsQ0FBQztRQUVELHVDQUFZLEdBQVo7WUFDSSxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU07Z0JBQUUsT0FBTyxxQkFBRyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUM7WUFDOUQsSUFBSSxDQUFDLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUU7Z0JBQzNCLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtvQkFBRSxPQUFPLHFCQUFHLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQztnQkFDakQsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFO29CQUFFLE9BQU8scUJBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDO2FBQ3REO1lBQ0QsSUFBSSxDQUFDLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUU7Z0JBQzNCLElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtvQkFBRSxPQUFPLHFCQUFHLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDO2dCQUNoRSxJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7b0JBQUUsT0FBTyxxQkFBRyxDQUFDLElBQUksQ0FBQyxZQUFZLENB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QUFDO1lBQ1gsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUU7Z0JBQ2xQLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3SyxPQUFPLENBQUMsQ0FBQTtRQUNaLENBQUM7UUFFRCxrQ0FBTyxHQUFQO1lB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QUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzFDLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzFDLEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFO29CQUFFLENBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQztnQkFDL0ksT0FBTyxDQUFDLENBQUMsQ0FBQTthQUNaO1lBQ0QsT0FBTyxDQUFDLENBQUMsQ0FBQTtRQUNiLENBQUM7UUFFRCxtQ0FBUSxHQUFSO1lBQ0ksS0FBSyxJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRTtnQkFDckQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUU7b0JBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDO1lBQzVKLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLEVBQUU7Z0JBQ2YsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7Z0JBQ3BCLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUMxQixJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztnQkFDakMsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFO29CQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7Z0JBQ2xILE9BQU8sQ0FBQyxDQUFDLENBQUE7YUFDWjtZQUNELE9BQU8sQ0FBQyxDQUFDLENBQUE7UUFDYixDQUFDO1FBRUQsa0NBQU8sR0FBUCxVQUFRLENBQUM7WUFDTCxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxQixDQUFDO1FBRUQscUNBQVUsR0FBVixVQUFXLEVBQUU7WUFDVCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFO2dCQUN6QyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO29CQUN4QixJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7b0JBQzNCLE1BQUs7aUJBQ1I7UUFDVCxDQUFDO1FBQ0wsdUJBQUM7SUFBRCxDQXZKQSxBQXVKQyxJQUFBO0lBdkpZLHdCQUFnQixtQkF1SjVCLENBQUE7QUFDTCxDQUFDLEVBekpnQixPQUFPLEdBQVAsZUFBTyxLQUFQLGVBQU8sUUF5SnZCO0FBRUQsa0JBQWUsT0FBTyxDQUFDLGdCQUFnQixDQUFDIiwiZmlsZSI6IiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENtZCBmcm9tICcuL01hdUJpbmguQ21kJztcblxuZXhwb3J0IG5hbWVzcGFjZSBtYXViaW5oIHtcbiAgICBleHBvcnQgY2xhc3MgRGV0ZWN0R3JvdXBDYXJkcyB7XG4gICAgICAgIGdyb3VwS2luZCA9IC0xO1xuICAgICAgICBjYXJkTGlzdCA9IFtdO1xuICAgICAgICB2YWx1ZUxpc3QgPSBbXTtcblxuICAgICAgICBnZXRHcm91cENhcmRzSW5mbygpIHtcbiAgICAgICAgICAgIHRoaXMuZ3JvdXBLaW5kID0gdGhpcy5nZXRHcm91cEtpbmQoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdyb3VwS2luZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGdldEdyb3VwS2luZCgpIHtcbiAgICAgICAgICAgIGlmICgxID09IHRoaXMuY2FyZExpc3QubGVuZ3RoKSByZXR1cm4gQ21kLkNvZGUuR1JPVVBfTUFVX1RIQVU7XG4gICAgICAgICAgICBpZiAoMyA9PSB0aGlzLmNhcmRMaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzU2FtQ28oKSkgcmV0dXJuIENtZC5Db2RlLkdST1VQX1NBTV9DTztcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01vdERvaSgpKSByZXR1cm4gQ21kLkNvZGUuR1JPVVBfTU9UX0RPSTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICg1ID09IHRoaXMuY2FyZExpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNUaHVuZ1BoYVNhbmgoKSkgcmV0dXJuIENtZC5Db2RlLkdST1VQX1RIVU5HX1BIQV9TQU5IO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzVHVRdXkoKSkgcmV0dXJuIENtZC5Db2RlLkdST1VQX1RVX1FVWTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0N1THUoKSkgcmV0dXJuIENtZC5Db2RlLkdST1VQX0NVX0xVO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzVGh1bmcoKSkgcmV0dXJuIENtZC5Db2RlLkdST1VQX1RIVU5HO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzU2FuaCgpKSByZXR1cm4gQ21kLkNvZGUuR1JPVVBfU0FOSDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1NhbUNvKCkpIHJldHVybiBDbWQuQ29kZS5HUk9VUF9TQU1fQ087XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNUaHUoKSkgcmV0dXJuIENtZC5Db2RlLkdST1VQX1RIVTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01vdERvaSgpKSByZXR1cm4gQ21kLkNvZGUuR1JPVVBfTU9UX0RPSTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudmFsdWVMaXN0ID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBhID0gdGhpcy5nZXRTb3J0ZWRDYXJkTGlzdCgpLCBiID0gdGhpcy5jYXJkTGlzdC5sZW5ndGggLSAxOyAwIDw9IGI7IGItLSkgdGhpcy52YWx1ZUxpc3QucHVzaChhW2JdLmdldE51bWJlcigpKTtcbiAgICAgICAgICAgIHJldHVybiBDbWQuQ29kZS5HUk9VUF9NQVVfVEhBVTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdldEdyb3VwS2luZExldmVsKGEpIHtcbiAgICAgICAgICAgIHZhciBiID0gQ21kLkNvZGUuTFZfQklOSF9USFVPTkc7XG4gICAgICAgICAgICAhYSB8fCB0aGlzLmdyb3VwS2luZCAhPSBDbWQuQ29kZS5HUk9VUF9USFVOR19QSEFfU0FOSCAmJiB0aGlzLmdyb3VwS2luZCAhPSBDbWQuQ29kZS5HUk9VUF9TQU5IIHx8ICgxMCA9PSB0aGlzLnZhbHVlTGlzdFswXSA/IGIgPSBDbWQuQ29kZS5MVl9USFVPTkcgOiAxID09IHRoaXMudmFsdWVMaXN0WzBdICYmIChiID0gQ21kLkNvZGUuTFZfSEEpKTtcbiAgICAgICAgICAgIHJldHVybiBiO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2V0U29ydGVkQ2FyZExpc3QoKSB7XG4gICAgICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgYiA9IDA7IGIgPCB0aGlzLmNhcmRMaXN0Lmxlbmd0aDsgYisrKSB7XG4gICAgICAgICAgICAgICAgYS5wdXNoKHRoaXMuY2FyZExpc3RbYl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gcmV0dXJuIGEuc29ydChmdW5jdGlvbiAoYSwgYykgeyByZXR1cm4gYy5nZXRJZCgpIC0gYS5nZXRJZCgpOyB9KTtcbiAgICAgICAgICAgIHJldHVybiBhLnNvcnQoZnVuY3Rpb24gKGEsIGMpIHsgcmV0dXJuIGEuZ2V0SWQoKSAtIGMuZ2V0SWQoKTsgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBzb3J0Q2FyZExpc3QoaXNJbmNyZWFzZSkge1xuICAgICAgICAgICAgaWYgKGlzSW5jcmVhc2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRMaXN0LnNvcnQoZnVuY3Rpb24gKGEsIGMpIHsgcmV0dXJuIGMgLSBhOyB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYXJkTGlzdC5zb3J0KGZ1bmN0aW9uIChhLCBjKSB7IHJldHVybiBhIC0gYzsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8vIEtpbmRzXG4gICAgICAgIGlzVGh1bmdQaGFTYW5oKCkge1xuICAgICAgICAgICAgaWYgKDUgIT0gdGhpcy5jYXJkTGlzdC5sZW5ndGgpIHJldHVybiAhMTtcbiAgICAgICAgICAgIGZvciAodmFyIGEgPSB0aGlzLmdldFNvcnRlZENhcmRMaXN0KCksIGIgPSAxLCBjID0gMTsgYyA8IHRoaXMuY2FyZExpc3QubGVuZ3RoOyBjKyspIGFbY10uZ2V0U3VpdCgpID09IGFbYyAtIDFdLmdldFN1aXQoKSAmJiAoYVtjXS5nZXROdW1iZXIoKSA9PSBhW2MgLSAxXS5nZXROdW1iZXIoKSArIDEgfHwgMiA9PSBhWzBdLmdldE51bWJlcigpICYmIDE0ID09IGFbY10uZ2V0TnVtYmVyKCkpICYmIGIrKztcbiAgICAgICAgICAgIGIgPT0gdGhpcy5jYXJkTGlzdC5sZW5ndGggJiYgKHRoaXMudmFsdWVMaXN0ID0gW10sIDIgPT0gYVswXS5nZXROdW1iZXIoKSAmJiAxNCA9PSBhW2EubGVuZ3RoIC0gMV0uZ2V0TnVtYmVyKCkgPyB0aGlzLnZhbHVlTGlzdC5wdXNoKDEpIDogdGhpcy52YWx1ZUxpc3QucHVzaChhWzBdLmdldE51bWJlcigpKSk7XG4gICAgICAgICAgICByZXR1cm4gYiA9PSB0aGlzLmNhcmRMaXN0Lmxlbmd0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlzVHVRdXkoKSB7XG4gICAgICAgICAgICBpZiAoNSAhPSB0aGlzLmNhcmRMaXN0Lmxlbmd0aCkgcmV0dXJuICExO1xuICAgICAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCB0aGlzLmNhcmRMaXN0Lmxlbmd0aDsgYSsrKVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGIgPSAxLCBjID0gMDsgYyA8IHRoaXMuY2FyZExpc3QubGVuZ3RoOyBjKyspXG4gICAgICAgICAgICAgICAgICAgIGlmIChhICE9IGMgJiYgdGhpcy5jYXJkTGlzdFthXS5nZXROdW1iZXIoKSA9PSB0aGlzLmNhcmRMaXN0W2NdLmdldE51bWJlcigpICYmIGIrKywgNCA9PSBiKSByZXR1cm4gdGhpcy52YWx1ZUxpc3QgPSBbXSwgdGhpcy52YWx1ZUxpc3QucHVzaCh0aGlzLmNhcmRMaXN0W2FdLmdldE51bWJlcigpKSwgITA7XG4gICAgICAgICAgICByZXR1cm4gITFcbiAgICAgICAgfVxuXG4gICAgICAgIGlzQ3VMdSgpIHtcbiAgICAgICAgICAgIGlmICg1ICE9IHRoaXMuY2FyZExpc3QubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgICAgICAgICB2YXIgYSA9IHRoaXMuZ2V0U29ydGVkQ2FyZExpc3QoKSxcbiAgICAgICAgICAgICAgICBiID0gITE7XG4gICAgICAgICAgICBhWzBdLmdldE51bWJlcigpID09IGFbMV0uZ2V0TnVtYmVyKCkgJiYgKGFbMV0uZ2V0TnVtYmVyKCkgPT0gYVsyXS5nZXROdW1iZXIoKSAmJiBhWzNdLmdldE51bWJlcigpID09IGFbNF0uZ2V0TnVtYmVyKCkgJiYgKGIgPSAhMCwgdGhpcy52YWx1ZUxpc3QgPSBbXSwgdGhpcy52YWx1ZUxpc3QucHVzaChhWzBdLmdldE51bWJlcigpKSwgdGhpcy52YWx1ZUxpc3QucHVzaChhWzNdLmdldE51bWJlcigpKSksIGFbMl0uZ2V0TnVtYmVyKCkgPT1cbiAgICAgICAgICAgICAgICBhWzNdLmdldE51bWJlcigpICYmIGFbM10uZ2V0TnVtYmVyKCkgPT0gYVs0XS5nZXROdW1iZXIoKSAmJiAoYiA9ICEwLCB0aGlzLnZhbHVlTGlzdCA9IFtdLCB0aGlzLnZhbHVlTGlzdC5wdXNoKGFbMl0uZ2V0TnVtYmVyKCkpLCB0aGlzLnZhbHVlTGlzdC5wdXNoKGFbMF0uZ2V0TnVtYmVyKCkpKSk7XG4gICAgICAgICAgICByZXR1cm4gYlxuICAgICAgICB9XG5cbiAgICAgICAgaXNUaHVuZygpIHtcbiAgICAgICAgICAgIHZhciBhID0gdGhpcy5nZXRTb3J0ZWRDYXJkTGlzdCgpO1xuICAgICAgICAgICAgaWYgKDUgIT0gdGhpcy5jYXJkTGlzdC5sZW5ndGgpIHJldHVybiAhMTtcbiAgICAgICAgICAgIGZvciAodmFyIGIgPSAxOyBiIDwgdGhpcy5jYXJkTGlzdC5sZW5ndGg7IGIrKylcbiAgICAgICAgICAgICAgICBpZiAoYVtiXS5nZXRTdWl0KCkgIT0gYVswXS5nZXRTdWl0KCkpIHJldHVybiAhMTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVMaXN0ID0gW107XG4gICAgICAgICAgICBmb3IgKGIgPSB0aGlzLmNhcmRMaXN0Lmxlbmd0aCAtIDE7IDAgPD0gYjsgYi0tKSB0aGlzLnZhbHVlTGlzdC5wdXNoKGFbYl0uZ2V0TnVtYmVyKCkpO1xuICAgICAgICAgICAgcmV0dXJuICEwXG4gICAgICAgIH1cblxuICAgICAgICBpc1NhbmgoKSB7XG4gICAgICAgICAgICBpZiAoNSAhPSB0aGlzLmNhcmRMaXN0Lmxlbmd0aCkgcmV0dXJuICExO1xuICAgICAgICAgICAgZm9yICh2YXIgYSA9IHRoaXMuZ2V0U29ydGVkQ2FyZExpc3QoKSwgYiA9IDEsIGMgPSAxOyBjIDwgdGhpcy5jYXJkTGlzdC5sZW5ndGg7IGMrKylcbiAgICAgICAgICAgICAgICAoYVtjXS5nZXROdW1iZXIoKSA9PSBhW2MgLSAxXS5nZXROdW1iZXIoKSArIDEgfHwgMiA9PSBhWzBdLmdldE51bWJlcigpICYmIDE0ID09IGFbY10uZ2V0TnVtYmVyKCkpICYmIGIrKztcbiAgICAgICAgICAgIGIgPT0gdGhpcy5jYXJkTGlzdC5sZW5ndGggJiYgKHRoaXMudmFsdWVMaXN0ID0gW10sIDIgPT0gYVswXS5nZXROdW1iZXIoKSAmJiAxNCA9PSBhW2EubGVuZ3RoIC0gMV0uZ2V0TnVtYmVyKClcbiAgICAgICAgICAgICAgICA/IHRoaXMudmFsdWVMaXN0LnB1c2goMSkgOiB0aGlzLnZhbHVlTGlzdC5wdXNoKGFbMF0uZ2V0TnVtYmVyKCkpKTtcbiAgICAgICAgICAgIHJldHVybiBiID09IHRoaXMuY2FyZExpc3QubGVuZ3RoO1xuICAgICAgICB9XG5cbiAgICAgICAgaXNTYW1DbygpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgdGhpcy5jYXJkTGlzdC5sZW5ndGg7IGErKykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGIgPSAxLCBjID0gMDsgYyA8IHRoaXMuY2FyZExpc3QubGVuZ3RoOyBjKyspIGEgIT0gYyAmJiB0aGlzLmNhcmRMaXN0W2FdLmdldE51bWJlcigpID09XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FyZExpc3RbY10uZ2V0TnVtYmVyKCkgJiYgYisrO1xuICAgICAgICAgICAgICAgIGlmICgzID09IGIpIHJldHVybiB0aGlzLnZhbHVlTGlzdCA9IFtdLCB0aGlzLnZhbHVlTGlzdC5wdXNoKHRoaXMuY2FyZExpc3RbYV0uZ2V0TnVtYmVyKCkpLCAhMFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICExXG4gICAgICAgIH1cblxuICAgICAgICBpc1RodSgpIHtcbiAgICAgICAgICAgIGlmICg1ICE9IHRoaXMuY2FyZExpc3QubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgICAgICAgICBmb3IgKHZhciBhID0gW10sIGIgPSAwOyBiIDwgdGhpcy5jYXJkTGlzdC5sZW5ndGggLSAxOyBiKyspXG4gICAgICAgICAgICAgICAgaWYgKC0xID09IGEuaW5kZXhPZih0aGlzLmNhcmRMaXN0W2JdLmdldE51bWJlcigpKSlcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IGIgKyAxOyBjIDwgdGhpcy5jYXJkTGlzdC5sZW5ndGg7IGMrKylcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNhcmRMaXN0W2JdLmdldE51bWJlcigpID09IHRoaXMuY2FyZExpc3RbY10uZ2V0TnVtYmVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnB1c2godGhpcy5jYXJkTGlzdFtiXS5nZXROdW1iZXIoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgyID09IGEubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZUxpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlTGlzdC5wdXNoKE1hdGgubWF4KGFbMF0sIGFbMV0pKTtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlTGlzdC5wdXNoKE1hdGgubWluKGFbMF0sIGFbMV0pKTtcbiAgICAgICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgdGhpcy5jYXJkTGlzdC5sZW5ndGg7IGIrKykgLSAxID09IGEuaW5kZXhPZih0aGlzLmNhcmRMaXN0W2JdLmdldE51bWJlcigpKSAmJiB0aGlzLnZhbHVlTGlzdC5wdXNoKHRoaXMuY2FyZExpc3RbYl0uZ2V0TnVtYmVyKCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiAhMFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICExXG4gICAgICAgIH1cblxuICAgICAgICBpc01vdERvaSgpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGEgPSBbXSwgYiA9IDA7IGIgPCB0aGlzLmNhcmRMaXN0Lmxlbmd0aCAtIDE7IGIrKylcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjID0gYiArIDE7IGMgPCB0aGlzLmNhcmRMaXN0Lmxlbmd0aDsgYysrKSB0aGlzLmNhcmRMaXN0W2JdLmdldE51bWJlcigpID09IHRoaXMuY2FyZExpc3RbY10uZ2V0TnVtYmVyKCkgJiYgYS5wdXNoKHRoaXMuY2FyZExpc3RbYl0uZ2V0TnVtYmVyKCkpO1xuICAgICAgICAgICAgaWYgKDEgPT0gYS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlTGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVMaXN0LnB1c2goYVswXSk7XG4gICAgICAgICAgICAgICAgbGV0IGQgPSB0aGlzLmdldFNvcnRlZENhcmRMaXN0KCk7XG4gICAgICAgICAgICAgICAgZm9yIChiID0gdGhpcy5jYXJkTGlzdC5sZW5ndGggLSAxOyAwIDw9IGI7IGItLSkgZFtiXS5nZXROdW1iZXIoKSAhPSBhWzBdICYmIHRoaXMudmFsdWVMaXN0LnB1c2goZFtiXS5nZXROdW1iZXIoKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEwXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gITFcbiAgICAgICAgfVxuXG4gICAgICAgIGFkZENhcmQoYSkge1xuICAgICAgICAgICAgdGhpcy5jYXJkTGlzdC5wdXNoKGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVtb3ZlQ2FyZChpZCkge1xuICAgICAgICAgICAgZm9yIChsZXQgYiA9IDA7IGIgPCB0aGlzLmNhcmRMaXN0Lmxlbmd0aDsgYisrKVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNhcmRMaXN0W2JdID09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FyZExpc3Quc3BsaWNlKGIsIDEpO1xuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgbWF1YmluaC5EZXRlY3RHcm91cENhcmRzO1xuXG4iXX0=