
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Loading/Add-on/DatePicker/resources/UIDatePicker/UIDatePicker.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '6d106l+tDRL5rbAU45iCnts', 'UIDatePicker');
// Loading/Add-on/DatePicker/resources/UIDatePicker/UIDatePicker.js

"use strict";

/** 
 * 日期组件
 */
cc.Class({
  "extends": cc.Component,
  properties: {
    lbYearMonth: cc.Label,
    ndDays: cc.Node,
    pfbDay: cc.Prefab,
    displayDate: cc.Label,
    contentShow: cc.Node,
    ChangeEvent: {
      "default": [],
      type: cc.Component.EventHandler
    }
  },
  onLoad: function onLoad() {
    this.initData();
    this.updateDate();
  },
  initData: function initData() {
    // this.date = this.date ? this.date : Date.now();
    this.date = new Date(Date.now());
    this.year = this.date.getFullYear();
    this.month = this.date.getMonth() + 1;
    this.day = this.date.getDate();
    this.pfgListDay = [];

    for (var i = 0; i < 31; ++i) {
      var node = cc.instantiate(this.pfbDay);
      node.parent = this.ndDays;
      this.pfgListDay.push(node);
    }
  },
  // 设置显示的日志，默认为当前日期
  setDate: function setDate(year, month, day) {
    this.date = new Date(year, month - 1, day);
    this.year = this.date.getFullYear();
    this.month = this.date.getMonth() + 1;
    this.day = this.date.getDate();
    this.updateDate();
  },
  updateDate: function updateDate() {
    var _this = this;

    // this.lbYearMonth.string = cc.js.formatStr("%s年%s月", this.year, this.month + 1);
    this.lbYearMonth.string = cc.js.formatStr("%s-%s", this.year, this.month + 1);
    var date = new Date(this.year, this.month - 1, 0);
    var totalDays = date.getDate();
    var fromWeek = date.getDay();

    for (var i = 0; i < this.pfgListDay.length; ++i) {
      var node = this.pfgListDay[i];

      if (i < totalDays) {
        node.active = true;
        var index = fromWeek + i;
        var row = Math.floor(index / 7);
        var col = index % 7;
        var x = -(this.ndDays.width - node.width) * 0.5 + col * node.width;
        var y = (this.ndDays.height - node.height) * 0.5 - row * node.height;
        node.setPosition(x, y);
        var script = node.getComponent("UIItemDay");
        script.setDay(i, i + 1, this.day === i + 1, function (selIndex, selDay) {
          _this.day = selDay;

          _this.updateDate();
        });
      } else {
        node.active = false;
      }
    }

    var month = ("0" + this.month).slice(-2);
    var day = ("0" + this.day).slice(-2);
    this.displayDate.string = day + "-" + month + "-" + this.year;
    this.CurrentDayChoose = this.year + "/" + month + "/" + day;
    this.onClickClose();
  },
  onClickLeft: function onClickLeft() {
    if (this.month > 0) {
      this.month -= 1;
    } else {
      this.month = 11;
      this.year -= 1;
    }

    this.date.setFullYear(this.year);
    this.date.setMonth(this.month);
    this.updateDate();
  },
  onClickRight: function onClickRight() {
    if (this.month < 11) {
      this.month += 1;
    } else {
      this.month = 0;
      this.year += 1;
    }

    this.date.setFullYear(this.year);
    this.date.setMonth(this.month);
    this.updateDate();
  },
  // 设置选中日期之后的回调
  setPickDateCallback: function setPickDateCallback(cb) {
    this.cb = cb;
  },
  onClickClose: function onClickClose() {
    if (this.cb) {
      this.cb(this.year, this.month, this.day);
    }

    if (this.ChangeEvent != null) {
      this.ChangeEvent.forEach(function (x) {
        x.emit();
      });
    }

    this.contentShow.active = false;
  },
  onClickShow: function onClickShow() {
    this.contentShow.active = true;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcTG9hZGluZ1xcQWRkLW9uXFxEYXRlUGlja2VyXFxyZXNvdXJjZXNcXFVJRGF0ZVBpY2tlclxcVUlEYXRlUGlja2VyLmpzIl0sIm5hbWVzIjpbImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwibGJZZWFyTW9udGgiLCJMYWJlbCIsIm5kRGF5cyIsIk5vZGUiLCJwZmJEYXkiLCJQcmVmYWIiLCJkaXNwbGF5RGF0ZSIsImNvbnRlbnRTaG93IiwiQ2hhbmdlRXZlbnQiLCJ0eXBlIiwiRXZlbnRIYW5kbGVyIiwib25Mb2FkIiwiaW5pdERhdGEiLCJ1cGRhdGVEYXRlIiwiZGF0ZSIsIkRhdGUiLCJub3ciLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJtb250aCIsImdldE1vbnRoIiwiZGF5IiwiZ2V0RGF0ZSIsInBmZ0xpc3REYXkiLCJpIiwibm9kZSIsImluc3RhbnRpYXRlIiwicGFyZW50IiwicHVzaCIsInNldERhdGUiLCJzdHJpbmciLCJqcyIsImZvcm1hdFN0ciIsInRvdGFsRGF5cyIsImZyb21XZWVrIiwiZ2V0RGF5IiwibGVuZ3RoIiwiYWN0aXZlIiwiaW5kZXgiLCJyb3ciLCJNYXRoIiwiZmxvb3IiLCJjb2wiLCJ4Iiwid2lkdGgiLCJ5IiwiaGVpZ2h0Iiwic2V0UG9zaXRpb24iLCJzY3JpcHQiLCJnZXRDb21wb25lbnQiLCJzZXREYXkiLCJzZWxJbmRleCIsInNlbERheSIsInNsaWNlIiwiQ3VycmVudERheUNob29zZSIsIm9uQ2xpY2tDbG9zZSIsIm9uQ2xpY2tMZWZ0Iiwic2V0RnVsbFllYXIiLCJzZXRNb250aCIsIm9uQ2xpY2tSaWdodCIsInNldFBpY2tEYXRlQ2FsbGJhY2siLCJjYiIsImZvckVhY2giLCJlbWl0Iiwib25DbGlja1Nob3ciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBRUFBLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ0wsYUFBU0QsRUFBRSxDQUFDRSxTQURQO0FBR0xDLEVBQUFBLFVBQVUsRUFBRTtBQUNSQyxJQUFBQSxXQUFXLEVBQUVKLEVBQUUsQ0FBQ0ssS0FEUjtBQUVSQyxJQUFBQSxNQUFNLEVBQUVOLEVBQUUsQ0FBQ08sSUFGSDtBQUdSQyxJQUFBQSxNQUFNLEVBQUVSLEVBQUUsQ0FBQ1MsTUFISDtBQUlSQyxJQUFBQSxXQUFXLEVBQUVWLEVBQUUsQ0FBQ0ssS0FKUjtBQUtSTSxJQUFBQSxXQUFXLEVBQUVYLEVBQUUsQ0FBQ08sSUFMUjtBQU1SSyxJQUFBQSxXQUFXLEVBQUM7QUFDUixpQkFBUSxFQURBO0FBRVJDLE1BQUFBLElBQUksRUFBQ2IsRUFBRSxDQUFDRSxTQUFILENBQWFZO0FBRlY7QUFOSixHQUhQO0FBZUxDLEVBQUFBLE1BZkssb0JBZUs7QUFDTixTQUFLQyxRQUFMO0FBQ0EsU0FBS0MsVUFBTDtBQUNILEdBbEJJO0FBb0JMRCxFQUFBQSxRQXBCSyxzQkFvQk07QUFDUDtBQUNBLFNBQUtFLElBQUwsR0FBWSxJQUFJQyxJQUFKLENBQVNBLElBQUksQ0FBQ0MsR0FBTCxFQUFULENBQVo7QUFFQSxTQUFLQyxJQUFMLEdBQVksS0FBS0gsSUFBTCxDQUFVSSxXQUFWLEVBQVo7QUFDQSxTQUFLQyxLQUFMLEdBQWEsS0FBS0wsSUFBTCxDQUFVTSxRQUFWLEtBQXVCLENBQXBDO0FBQ0EsU0FBS0MsR0FBTCxHQUFXLEtBQUtQLElBQUwsQ0FBVVEsT0FBVixFQUFYO0FBQ0EsU0FBS0MsVUFBTCxHQUFrQixFQUFsQjs7QUFDQSxTQUFLLElBQUlDLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUcsRUFBcEIsRUFBd0IsRUFBRUEsQ0FBMUIsRUFBNkI7QUFDekIsVUFBSUMsSUFBSSxHQUFHN0IsRUFBRSxDQUFDOEIsV0FBSCxDQUFlLEtBQUt0QixNQUFwQixDQUFYO0FBQ0FxQixNQUFBQSxJQUFJLENBQUNFLE1BQUwsR0FBYyxLQUFLekIsTUFBbkI7QUFDQSxXQUFLcUIsVUFBTCxDQUFnQkssSUFBaEIsQ0FBcUJILElBQXJCO0FBQ0g7QUFDSixHQWpDSTtBQW1DTDtBQUNBSSxFQUFBQSxPQXBDSyxtQkFvQ0daLElBcENILEVBb0NTRSxLQXBDVCxFQW9DZ0JFLEdBcENoQixFQW9DcUI7QUFDdEIsU0FBS1AsSUFBTCxHQUFZLElBQUlDLElBQUosQ0FBU0UsSUFBVCxFQUFlRSxLQUFLLEdBQUcsQ0FBdkIsRUFBMEJFLEdBQTFCLENBQVo7QUFDQSxTQUFLSixJQUFMLEdBQVksS0FBS0gsSUFBTCxDQUFVSSxXQUFWLEVBQVo7QUFDQSxTQUFLQyxLQUFMLEdBQWEsS0FBS0wsSUFBTCxDQUFVTSxRQUFWLEtBQXVCLENBQXBDO0FBQ0EsU0FBS0MsR0FBTCxHQUFXLEtBQUtQLElBQUwsQ0FBVVEsT0FBVixFQUFYO0FBR0EsU0FBS1QsVUFBTDtBQUVILEdBN0NJO0FBK0NMQSxFQUFBQSxVQS9DSyx3QkErQ1M7QUFBQTs7QUFDVjtBQUNBLFNBQUtiLFdBQUwsQ0FBaUI4QixNQUFqQixHQUEwQmxDLEVBQUUsQ0FBQ21DLEVBQUgsQ0FBTUMsU0FBTixDQUFnQixPQUFoQixFQUF5QixLQUFLZixJQUE5QixFQUFvQyxLQUFLRSxLQUFMLEdBQWEsQ0FBakQsQ0FBMUI7QUFFQSxRQUFJTCxJQUFJLEdBQUcsSUFBSUMsSUFBSixDQUFTLEtBQUtFLElBQWQsRUFBb0IsS0FBS0UsS0FBTCxHQUFhLENBQWpDLEVBQW9DLENBQXBDLENBQVg7QUFDQSxRQUFJYyxTQUFTLEdBQUduQixJQUFJLENBQUNRLE9BQUwsRUFBaEI7QUFDQSxRQUFJWSxRQUFRLEdBQUdwQixJQUFJLENBQUNxQixNQUFMLEVBQWY7O0FBQ0EsU0FBSyxJQUFJWCxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUtELFVBQUwsQ0FBZ0JhLE1BQXBDLEVBQTRDLEVBQUVaLENBQTlDLEVBQWlEO0FBQzdDLFVBQUlDLElBQUksR0FBRyxLQUFLRixVQUFMLENBQWdCQyxDQUFoQixDQUFYOztBQUNBLFVBQUlBLENBQUMsR0FBR1MsU0FBUixFQUFtQjtBQUNmUixRQUFBQSxJQUFJLENBQUNZLE1BQUwsR0FBYyxJQUFkO0FBQ0EsWUFBSUMsS0FBSyxHQUFHSixRQUFRLEdBQUdWLENBQXZCO0FBQ0EsWUFBSWUsR0FBRyxHQUFHQyxJQUFJLENBQUNDLEtBQUwsQ0FBV0gsS0FBSyxHQUFHLENBQW5CLENBQVY7QUFDQSxZQUFJSSxHQUFHLEdBQUdKLEtBQUssR0FBRyxDQUFsQjtBQUNBLFlBQUlLLENBQUMsR0FBRyxFQUFFLEtBQUt6QyxNQUFMLENBQVkwQyxLQUFaLEdBQW9CbkIsSUFBSSxDQUFDbUIsS0FBM0IsSUFBb0MsR0FBcEMsR0FBMENGLEdBQUcsR0FBR2pCLElBQUksQ0FBQ21CLEtBQTdEO0FBQ0EsWUFBSUMsQ0FBQyxHQUFHLENBQUMsS0FBSzNDLE1BQUwsQ0FBWTRDLE1BQVosR0FBcUJyQixJQUFJLENBQUNxQixNQUEzQixJQUFxQyxHQUFyQyxHQUEyQ1AsR0FBRyxHQUFHZCxJQUFJLENBQUNxQixNQUE5RDtBQUNBckIsUUFBQUEsSUFBSSxDQUFDc0IsV0FBTCxDQUFpQkosQ0FBakIsRUFBb0JFLENBQXBCO0FBQ0EsWUFBSUcsTUFBTSxHQUFHdkIsSUFBSSxDQUFDd0IsWUFBTCxDQUFrQixXQUFsQixDQUFiO0FBQ0FELFFBQUFBLE1BQU0sQ0FBQ0UsTUFBUCxDQUFjMUIsQ0FBZCxFQUFpQkEsQ0FBQyxHQUFHLENBQXJCLEVBQXdCLEtBQUtILEdBQUwsS0FBYUcsQ0FBQyxHQUFHLENBQXpDLEVBQTRDLFVBQUMyQixRQUFELEVBQVdDLE1BQVgsRUFBb0I7QUFDNUQsVUFBQSxLQUFJLENBQUMvQixHQUFMLEdBQVcrQixNQUFYOztBQUNBLFVBQUEsS0FBSSxDQUFDdkMsVUFBTDtBQUNILFNBSEQ7QUFJSCxPQWJELE1BYU87QUFDSFksUUFBQUEsSUFBSSxDQUFDWSxNQUFMLEdBQWMsS0FBZDtBQUNIO0FBQ0o7O0FBQ0QsUUFBSWxCLEtBQUssR0FBRyxDQUFDLE1BQU0sS0FBS0EsS0FBWixFQUFtQmtDLEtBQW5CLENBQXlCLENBQUMsQ0FBMUIsQ0FBWjtBQUNBLFFBQUloQyxHQUFHLEdBQUcsQ0FBQyxNQUFNLEtBQUtBLEdBQVosRUFBaUJnQyxLQUFqQixDQUF1QixDQUFDLENBQXhCLENBQVY7QUFDQSxTQUFLL0MsV0FBTCxDQUFpQndCLE1BQWpCLEdBQTBCVCxHQUFHLEdBQUUsR0FBTCxHQUFVRixLQUFWLEdBQWlCLEdBQWpCLEdBQXFCLEtBQUtGLElBQXBEO0FBQ0EsU0FBS3FDLGdCQUFMLEdBQXdCLEtBQUtyQyxJQUFMLEdBQVUsR0FBVixHQUFlRSxLQUFmLEdBQXFCLEdBQXJCLEdBQTJCRSxHQUFuRDtBQUNBLFNBQUtrQyxZQUFMO0FBQ0gsR0E5RUk7QUFnRkxDLEVBQUFBLFdBaEZLLHlCQWdGVTtBQUNYLFFBQUksS0FBS3JDLEtBQUwsR0FBYSxDQUFqQixFQUFvQjtBQUNoQixXQUFLQSxLQUFMLElBQWMsQ0FBZDtBQUNILEtBRkQsTUFFTztBQUNILFdBQUtBLEtBQUwsR0FBYSxFQUFiO0FBQ0EsV0FBS0YsSUFBTCxJQUFhLENBQWI7QUFDSDs7QUFDRCxTQUFLSCxJQUFMLENBQVUyQyxXQUFWLENBQXNCLEtBQUt4QyxJQUEzQjtBQUNBLFNBQUtILElBQUwsQ0FBVTRDLFFBQVYsQ0FBbUIsS0FBS3ZDLEtBQXhCO0FBQ0EsU0FBS04sVUFBTDtBQUNILEdBMUZJO0FBNEZMOEMsRUFBQUEsWUE1RkssMEJBNEZXO0FBQ1osUUFBSSxLQUFLeEMsS0FBTCxHQUFhLEVBQWpCLEVBQXFCO0FBQ2pCLFdBQUtBLEtBQUwsSUFBYyxDQUFkO0FBQ0gsS0FGRCxNQUVPO0FBQ0gsV0FBS0EsS0FBTCxHQUFhLENBQWI7QUFDQSxXQUFLRixJQUFMLElBQWEsQ0FBYjtBQUNIOztBQUNELFNBQUtILElBQUwsQ0FBVTJDLFdBQVYsQ0FBc0IsS0FBS3hDLElBQTNCO0FBQ0EsU0FBS0gsSUFBTCxDQUFVNEMsUUFBVixDQUFtQixLQUFLdkMsS0FBeEI7QUFDQSxTQUFLTixVQUFMO0FBQ0gsR0F0R0k7QUF3R0w7QUFDQStDLEVBQUFBLG1CQXpHSywrQkF5R2VDLEVBekdmLEVBeUdtQjtBQUNwQixTQUFLQSxFQUFMLEdBQVVBLEVBQVY7QUFDSCxHQTNHSTtBQTZHTE4sRUFBQUEsWUE3R0ssMEJBNkdXO0FBQ1osUUFBSSxLQUFLTSxFQUFULEVBQWE7QUFDVCxXQUFLQSxFQUFMLENBQVEsS0FBSzVDLElBQWIsRUFBbUIsS0FBS0UsS0FBeEIsRUFBK0IsS0FBS0UsR0FBcEM7QUFDSDs7QUFDRCxRQUFHLEtBQUtiLFdBQUwsSUFBb0IsSUFBdkIsRUFDQTtBQUNJLFdBQUtBLFdBQUwsQ0FBaUJzRCxPQUFqQixDQUF5QixVQUFBbkIsQ0FBQyxFQUFHO0FBQ3pCQSxRQUFBQSxDQUFDLENBQUNvQixJQUFGO0FBQ0gsT0FGRDtBQUlIOztBQUNELFNBQUt4RCxXQUFMLENBQWlCOEIsTUFBakIsR0FBMEIsS0FBMUI7QUFDSCxHQXpISTtBQTBITDJCLEVBQUFBLFdBMUhLLHlCQTJITDtBQUNJLFNBQUt6RCxXQUFMLENBQWlCOEIsTUFBakIsR0FBMEIsSUFBMUI7QUFDSDtBQTdISSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyIvKiogXG4gKiDml6XmnJ/nu4Tku7ZcbiAqL1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYlllYXJNb250aDogY2MuTGFiZWwsXG4gICAgICAgIG5kRGF5czogY2MuTm9kZSxcbiAgICAgICAgcGZiRGF5OiBjYy5QcmVmYWIsXG4gICAgICAgIGRpc3BsYXlEYXRlOiBjYy5MYWJlbCxcbiAgICAgICAgY29udGVudFNob3c6IGNjLk5vZGUsXG4gICAgICAgIENoYW5nZUV2ZW50OntcbiAgICAgICAgICAgIGRlZmF1bHQ6W10sXG4gICAgICAgICAgICB0eXBlOmNjLkNvbXBvbmVudC5FdmVudEhhbmRsZXJcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkxvYWQgKCkge1xuICAgICAgICB0aGlzLmluaXREYXRhKCk7XG4gICAgICAgIHRoaXMudXBkYXRlRGF0ZSgpO1xuICAgIH0sXG5cbiAgICBpbml0RGF0YSgpIHtcbiAgICAgICAgLy8gdGhpcy5kYXRlID0gdGhpcy5kYXRlID8gdGhpcy5kYXRlIDogRGF0ZS5ub3coKTtcbiAgICAgICAgdGhpcy5kYXRlID0gbmV3IERhdGUoRGF0ZS5ub3coKSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnllYXIgPSB0aGlzLmRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgdGhpcy5tb250aCA9IHRoaXMuZGF0ZS5nZXRNb250aCgpICsgMTtcbiAgICAgICAgdGhpcy5kYXkgPSB0aGlzLmRhdGUuZ2V0RGF0ZSgpO1xuICAgICAgICB0aGlzLnBmZ0xpc3REYXkgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzMTsgKytpKSB7XG4gICAgICAgICAgICBsZXQgbm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMucGZiRGF5KTtcbiAgICAgICAgICAgIG5vZGUucGFyZW50ID0gdGhpcy5uZERheXM7XG4gICAgICAgICAgICB0aGlzLnBmZ0xpc3REYXkucHVzaChub2RlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyDorr7nva7mmL7npLrnmoTml6Xlv5fvvIzpu5jorqTkuLrlvZPliY3ml6XmnJ9cbiAgICBzZXREYXRlKHllYXIsIG1vbnRoLCBkYXkpIHtcbiAgICAgICAgdGhpcy5kYXRlID0gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXkpO1xuICAgICAgICB0aGlzLnllYXIgPSB0aGlzLmRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgdGhpcy5tb250aCA9IHRoaXMuZGF0ZS5nZXRNb250aCgpICsgMTtcbiAgICAgICAgdGhpcy5kYXkgPSB0aGlzLmRhdGUuZ2V0RGF0ZSgpO1xuXG4gICAgICAgIFxuICAgICAgICB0aGlzLnVwZGF0ZURhdGUoKTtcbiAgICAgICAgXG4gICAgfSxcblxuICAgIHVwZGF0ZURhdGUgKCkge1xuICAgICAgICAvLyB0aGlzLmxiWWVhck1vbnRoLnN0cmluZyA9IGNjLmpzLmZvcm1hdFN0cihcIiVz5bm0JXPmnIhcIiwgdGhpcy55ZWFyLCB0aGlzLm1vbnRoICsgMSk7XG4gICAgICAgIHRoaXMubGJZZWFyTW9udGguc3RyaW5nID0gY2MuanMuZm9ybWF0U3RyKFwiJXMtJXNcIiwgdGhpcy55ZWFyLCB0aGlzLm1vbnRoICsgMSk7XG5cbiAgICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSh0aGlzLnllYXIsIHRoaXMubW9udGggLSAxLCAwKTtcbiAgICAgICAgbGV0IHRvdGFsRGF5cyA9IGRhdGUuZ2V0RGF0ZSgpO1xuICAgICAgICBsZXQgZnJvbVdlZWsgPSBkYXRlLmdldERheSgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucGZnTGlzdERheS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgbGV0IG5vZGUgPSB0aGlzLnBmZ0xpc3REYXlbaV07XG4gICAgICAgICAgICBpZiAoaSA8IHRvdGFsRGF5cykge1xuICAgICAgICAgICAgICAgIG5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSBmcm9tV2VlayArIGk7XG4gICAgICAgICAgICAgICAgbGV0IHJvdyA9IE1hdGguZmxvb3IoaW5kZXggLyA3KTtcbiAgICAgICAgICAgICAgICBsZXQgY29sID0gaW5kZXggJSA3O1xuICAgICAgICAgICAgICAgIGxldCB4ID0gLSh0aGlzLm5kRGF5cy53aWR0aCAtIG5vZGUud2lkdGgpICogMC41ICsgY29sICogbm9kZS53aWR0aDtcbiAgICAgICAgICAgICAgICBsZXQgeSA9ICh0aGlzLm5kRGF5cy5oZWlnaHQgLSBub2RlLmhlaWdodCkgKiAwLjUgLSByb3cgKiBub2RlLmhlaWdodDtcbiAgICAgICAgICAgICAgICBub2RlLnNldFBvc2l0aW9uKHgsIHkpO1xuICAgICAgICAgICAgICAgIGxldCBzY3JpcHQgPSBub2RlLmdldENvbXBvbmVudChcIlVJSXRlbURheVwiKTtcbiAgICAgICAgICAgICAgICBzY3JpcHQuc2V0RGF5KGksIGkgKyAxLCB0aGlzLmRheSA9PT0gaSArIDEsIChzZWxJbmRleCwgc2VsRGF5KT0+e1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRheSA9IHNlbERheTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1vbnRoID0gKFwiMFwiICsgdGhpcy5tb250aCkuc2xpY2UoLTIpO1xuICAgICAgICB2YXIgZGF5ID0gKFwiMFwiICsgdGhpcy5kYXkpLnNsaWNlKC0yKTtcbiAgICAgICAgdGhpcy5kaXNwbGF5RGF0ZS5zdHJpbmcgPSBkYXkgK1wiLVwiICttb250aCArXCItXCIrdGhpcy55ZWFyO1xuICAgICAgICB0aGlzLkN1cnJlbnREYXlDaG9vc2UgPSB0aGlzLnllYXIrXCIvXCIrIG1vbnRoK1wiL1wiICsgZGF5O1xuICAgICAgICB0aGlzLm9uQ2xpY2tDbG9zZSgpO1xuICAgIH0sXG5cbiAgICBvbkNsaWNrTGVmdCAoKSB7XG4gICAgICAgIGlmICh0aGlzLm1vbnRoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5tb250aCAtPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tb250aCA9IDExO1xuICAgICAgICAgICAgdGhpcy55ZWFyIC09IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kYXRlLnNldEZ1bGxZZWFyKHRoaXMueWVhcik7XG4gICAgICAgIHRoaXMuZGF0ZS5zZXRNb250aCh0aGlzLm1vbnRoKTtcbiAgICAgICAgdGhpcy51cGRhdGVEYXRlKCk7XG4gICAgfSxcblxuICAgIG9uQ2xpY2tSaWdodCAoKSB7XG4gICAgICAgIGlmICh0aGlzLm1vbnRoIDwgMTEpIHtcbiAgICAgICAgICAgIHRoaXMubW9udGggKz0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubW9udGggPSAwO1xuICAgICAgICAgICAgdGhpcy55ZWFyICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kYXRlLnNldEZ1bGxZZWFyKHRoaXMueWVhcik7XG4gICAgICAgIHRoaXMuZGF0ZS5zZXRNb250aCh0aGlzLm1vbnRoKTtcbiAgICAgICAgdGhpcy51cGRhdGVEYXRlKCk7XG4gICAgfSxcblxuICAgIC8vIOiuvue9rumAieS4reaXpeacn+S5i+WQjueahOWbnuiwg1xuICAgIHNldFBpY2tEYXRlQ2FsbGJhY2soY2IpIHtcbiAgICAgICAgdGhpcy5jYiA9IGNiO1xuICAgIH0sXG5cbiAgICBvbkNsaWNrQ2xvc2UgKCkge1xuICAgICAgICBpZiAodGhpcy5jYikge1xuICAgICAgICAgICAgdGhpcy5jYih0aGlzLnllYXIsIHRoaXMubW9udGgsIHRoaXMuZGF5KTtcbiAgICAgICAgfVxuICAgICAgICBpZih0aGlzLkNoYW5nZUV2ZW50ICE9IG51bGwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuQ2hhbmdlRXZlbnQuZm9yRWFjaCh4ID0+e1xuICAgICAgICAgICAgICAgIHguZW1pdCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29udGVudFNob3cuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcbiAgICBvbkNsaWNrU2hvdygpXG4gICAge1xuICAgICAgICB0aGlzLmNvbnRlbnRTaG93LmFjdGl2ZSA9IHRydWU7XG4gICAgfVxufSk7XG4iXX0=