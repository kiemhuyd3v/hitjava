{"version":3,"sources":["assets\\TaiXiuSieuToc\\Scripts\\TaiXiuST.PopupHistory.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAEA,iEAA4D;AAC5D,uEAAkE;AAElE,qEAAgE;AAChE,mHAAwG;AAIlG,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAE5C,IAAU,aAAa,CAuHtB;AAvHD,WAAU,aAAa;IAEnB;QAAkC,gCAAM;QAAxC;YAAA,qEAmHC;YAhHG,aAAO,GAAa,IAAI,CAAC;YAGzB,YAAM,GAAY,IAAI,CAAC;YAEvB,YAAM,GAAkB,IAAI,CAAC;YAE7B,6BAA6B;YAC7B,oCAAoC;YAE5B,UAAI,GAAW,CAAC,CAAC;YACjB,aAAO,GAAW,CAAC,CAAC;YACpB,WAAK,GAAG,IAAI,KAAK,EAAW,CAAC;YAC7B,iBAAW,GAAG,EAAE,CAAC;YACjB,qBAAe,GAAG,CAAC,CAAC;;QAkGhC,CAAC;QAhGG,6BAAM,GAAN;QAEA,CAAC;QAED,2BAAI,GAAJ;YACI,iBAAM,IAAI,WAAE,CAAC;YACb,aAAG,CAAC,QAAQ,CAAC,cAAc,CAAC,eAAe,CAAC,CAAC;YAC7C,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;YACtB,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;YACzB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACxC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC;aAChC;QACL,CAAC;QAED,8BAAO,GAAP;YACI,iBAAM,OAAO,WAAE,CAAC;YAChB,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,iBAAiB,EAAE,CAAC;YACxC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACxC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC;aAChC;QACL,CAAC;QAED,gCAAS,GAAT;YACI,iBAAM,SAAS,WAAE,CAAC;YAElB,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;YACd,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;YACjB,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC;YACrD,IAAI,CAAC,QAAQ,EAAE,CAAC;QACpB,CAAC;QAED,kCAAW,GAAX;YACI,IAAI,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE;gBAC1B,IAAI,CAAC,IAAI,EAAE,CAAC;gBACZ,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC;gBACrD,IAAI,CAAC,QAAQ,EAAE,CAAC;aACnB;QACL,CAAC;QAED,kCAAW,GAAX;YACI,IAAI,IAAI,CAAC,IAAI,GAAG,CAAC,EAAE;gBACf,IAAI,CAAC,IAAI,EAAE,CAAC;gBACZ,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC;gBACrD,IAAI,CAAC,QAAQ,EAAE,CAAC;aACnB;QACL,CAAC;QAEO,+BAAQ,GAAhB,UAAiB,WAAkB;YAAnC,iBAcC;YAdgB,4BAAA,EAAA,kBAAkB;YAC/B,aAAG,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAC/B,qCAAqB,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,UAAC,GAAG,EAAE,GAAG;gBACvE,aAAG,CAAC,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;gBAChC,IAAI,GAAG,IAAI,IAAI,EAAE;oBACb,wBAAwB;oBACxB,OAAO;iBACV;gBAAA,CAAC;gBACF,IAAI,GAAG,CAAC,SAAS,CAAC,IAAI,QAAQ;oBAAE,OAAO;gBACvC,0BAA0B;gBAC1B,KAAI,CAAC,OAAO,GAAG,GAAG,CAAC,YAAY,CAAC,CAAC;gBACjC,KAAI,CAAC,OAAO,CAAC,MAAM,GAAG,KAAI,CAAC,IAAI,GAAG,GAAG,GAAG,KAAI,CAAC,OAAO,CAAC;gBACrD,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;YACrC,CAAC,CAAC,CAAC;QACP,CAAC;QACD,kCAAW,GAAX,UAAY,WAAW;YACnB,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,iBAAiB,EAAE,CAAC;YACxC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAI,IAAI,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBACvC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;gBAClC,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;gBACzB,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;aAC1C;YACD,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;QACjC,CAAC;QACD,kCAAW,GAAX,UAAY,IAAI,EAAE,QAAQ;YACtB,IAAI,KAAK,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAA;YAC7B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,OAAO,GAAG,KAAK,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;YAC7D,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,GAAG,GAAG,QAAQ,CAAC,UAAU,CAAC,CAAC;YAC7F,IAAI,IAAI,GAAG,QAAQ,CAAC,SAAS,CAAC,CAAC;YAC/B,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;YACzC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;YACvF,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC;YACzG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;YAC/I,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,eAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;YACxG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,eAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC,CAAC;YAC9G,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;YAC3J,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,eAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;YACxG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;YACrJ,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACvB,CAAC;QACD,oCAAa,GAAb,UAAc,UAAU,EAAE,SAAS,EAAE,eAAe;YAChD,IAAI,SAAS,IAAI,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,gBAAgB,EAAE;gBACvD,IAAI,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE;oBAC1B,IAAI,CAAC,IAAI,EAAE,CAAC;oBACZ,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;iBACxB;aACJ;QACL,CAAC;QA/GD;YADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;qDACM;QAGzB;YADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;oDACK;QAEvB;YADC,QAAQ,CAAC,EAAE,CAAC,UAAU,CAAC;oDACK;QARpB,YAAY;YADxB,OAAO;WACK,YAAY,CAmHxB;QAAD,mBAAC;KAnHD,AAmHC,CAnHiC,gBAAM,GAmHvC;IAnHY,0BAAY,eAmHxB,CAAA;AAEL,CAAC,EAvHS,aAAa,KAAb,aAAa,QAuHtB;AACD,kBAAe,aAAa,CAAC,YAAY,CAAC","file":"","sourceRoot":"/","sourcesContent":["import Configs from \"../../Loading/src/Configs\";\nimport Http from \"../../Loading/src/Http\";\nimport App from \"../../Lobby/LobbyScript/Script/common/App\";\nimport Dialog from \"../../Lobby/LobbyScript/Script/common/Dialog\";\nimport ScrollViewControl from \"../../Lobby/LobbyScript/Script/common/ScrollViewControl\";\nimport Utils from \"../../Lobby/LobbyScript/Script/common/Utils\";\nimport TaiXiuSTNetworkClient from \"../../Lobby/LobbyScript/Script/networks/TaiXiuSieuToc.NetworkClient\";\nimport cmd from \"./TaiXiuSieuToc.Cmd\";\n\n\nconst { ccclass, property } = cc._decorator;\n\nnamespace TaiXiuSieuToc {\n    @ccclass\n    export class PopupHistory extends Dialog {\n\n        @property(cc.Label)\n        lblPage: cc.Label = null;\n\n        @property(cc.Node)\n        prefab: cc.Node = null;\n        @property(cc.ScrollView)\n        scroll: cc.ScrollView = null;\n\n        // @property([cc.BitmapFont])\n        // fontNumber: cc.BitmapFont[] = [];\n\n        private page: number = 1;\n        private maxPage: number = 1;\n        private items = new Array<cc.Node>();\n        private historyData = [];\n        private totalPageLoaded = 0;\n\n        onLoad() {\n\n        }\n\n        show() {\n            super.show();\n            App.instance.showBgMiniGame(\"TaiXiuSieuToc\");\n            this.historyData = [];\n            this.totalPageLoaded = 0;\n            for (let i = 0; i < this.items.length; i++) {\n                this.items[i].active = false;\n            }\n        }\n\n        dismiss() {\n            super.dismiss();\n            this.scroll.content.removeAllChildren();\n            for (let i = 0; i < this.items.length; i++) {\n                this.items[i].active = false;\n            }\n        }\n\n        _onShowed() {\n            super._onShowed();\n\n            this.page = 1;\n            this.maxPage = 1;\n            this.lblPage.string = this.page + \"/\" + this.maxPage;\n            this.loadData();\n        }\n\n        actNextPage() {\n            if (this.page < this.maxPage) {\n                this.page++;\n                this.lblPage.string = this.page + \"/\" + this.maxPage;\n                this.loadData();\n            }\n        }\n\n        actPrevPage() {\n            if (this.page > 1) {\n                this.page--;\n                this.lblPage.string = this.page + \"/\" + this.maxPage;\n                this.loadData();\n            }\n        }\n\n        private loadData(isReloadScr = true) {\n            App.instance.showLoading(true);\n            TaiXiuSTNetworkClient.getInstance().getHistory(this.page - 1, 10, (err, res) => {\n                App.instance.showLoading(false);\n                if (err != null) {\n                    //  cc.log(\"err:\", err);\n                    return;\n                };\n                if (res[\"message\"] != \"SUCCES\") return;\n                // this.totalPageLoaded++;\n                this.maxPage = res[\"totalPages\"];\n                this.lblPage.string = this.page + \"/\" + this.maxPage;\n                this.loadHistory(res[\"content\"]);\n            });\n        }\n        loadHistory(datahistory) {\n            this.scroll.content.removeAllChildren();\n            for (var i = 0; i < datahistory.length; i++) {\n                var node = cc.instantiate(this.prefab);\n                node.parent = this.scroll.content;\n                datahistory[i].index = i;\n                this.setItemData(node, datahistory[i]);\n            }\n            this.scroll.scrollToTop(0.3);\n        }\n        setItemData(item, itemData) {\n            let index = itemData['index']\n            item.getChildByName(\"bg\").opacity = index % 2 == 0 ? 255 : 0;\n            item.getChildByName(\"lblSession\").getComponent(cc.Label).string = \"#\" + itemData[\"taixiuId\"];\n            let time = itemData[\"bettime\"];\n            time = time.substr(0, time.indexOf(\".\"));\n            item.getChildByName(\"lblTime\").getComponent(cc.Label).string = time.replace(\"T\", \"\\n\");\n            item.getChildByName(\"lblBetDoor\").getComponent(cc.Label).string = itemData[\"typed\"] == 1 ? \"TÀI\" : \"XỈU\";\n            item.getChildByName(\"lblResult\").getComponent(cc.Label).string = itemData[\"description\"] == null ? \"Chưa có kết quả\" : itemData[\"description\"];\n            item.getChildByName(\"lblBet\").getComponent(cc.Label).string = Utils.formatNumber(itemData[\"betamount\"]);\n            item.getChildByName(\"lblRefund\").getComponent(cc.Label).string = Utils.formatNumber(itemData[\"refundamount\"]);\n            item.getChildByName(\"lblRefund\").getComponent(cc.Label).node.color = itemData['refundamount'] > 0 ? new cc.Color(240, 191, 11) : new cc.Color(240, 48, 11);\n            item.getChildByName(\"lblWin\").getComponent(cc.Label).string = Utils.formatNumber(itemData[\"winamount\"]);\n            item.getChildByName(\"lblWin\").getComponent(cc.Label).node.color = itemData['winamount'] > 0 ? new cc.Color(240, 191, 11) : new cc.Color(240, 48, 11);\n            item.active = true;\n        }\n        onScrollEvent(scrollview, eventType, customEventData) {\n            if (eventType == cc.ScrollView.EventType.SCROLL_TO_BOTTOM) {\n                if (this.page < this.maxPage) {\n                    this.page++;\n                    this.loadData(false);\n                }\n            }\n        }\n    }\n\n}\nexport default TaiXiuSieuToc.PopupHistory;"]}