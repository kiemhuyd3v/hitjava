{"version":3,"sources":["assets\\Loading\\Add-on\\DatePicker\\resources\\UIDatePicker\\UIDatePicker.js"],"names":["cc","Class","Component","properties","lbYearMonth","Label","ndDays","Node","pfbDay","Prefab","displayDate","contentShow","ChangeEvent","type","EventHandler","onLoad","initData","updateDate","date","Date","now","year","getFullYear","month","getMonth","day","getDate","pfgListDay","i","node","instantiate","parent","push","setDate","string","js","formatStr","totalDays","fromWeek","getDay","length","active","index","row","Math","floor","col","x","width","y","height","setPosition","script","getComponent","setDay","selIndex","selDay","slice","CurrentDayChoose","onClickClose","onClickLeft","setFullYear","setMonth","onClickRight","setPickDateCallback","cb","forEach","emit","onClickShow"],"mappings":"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","sourceRoot":"/","sourcesContent":["/** \n * 日期组件\n */\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        lbYearMonth: cc.Label,\n        ndDays: cc.Node,\n        pfbDay: cc.Prefab,\n        displayDate: cc.Label,\n        contentShow: cc.Node,\n        ChangeEvent:{\n            default:[],\n            type:cc.Component.EventHandler\n        }\n    },\n\n    onLoad () {\n        this.initData();\n        this.updateDate();\n    },\n\n    initData() {\n        // this.date = this.date ? this.date : Date.now();\n        this.date = new Date(Date.now());\n        \n        this.year = this.date.getFullYear();\n        this.month = this.date.getMonth() + 1;\n        this.day = this.date.getDate();\n        this.pfgListDay = [];\n        for (let i = 0; i < 31; ++i) {\n            let node = cc.instantiate(this.pfbDay);\n            node.parent = this.ndDays;\n            this.pfgListDay.push(node);\n        }\n    },\n\n    // 设置显示的日志，默认为当前日期\n    setDate(year, month, day) {\n        this.date = new Date(year, month - 1, day);\n        this.year = this.date.getFullYear();\n        this.month = this.date.getMonth() + 1;\n        this.day = this.date.getDate();\n\n        \n        this.updateDate();\n        \n    },\n\n    updateDate () {\n        // this.lbYearMonth.string = cc.js.formatStr(\"%s年%s月\", this.year, this.month + 1);\n        this.lbYearMonth.string = cc.js.formatStr(\"%s-%s\", this.year, this.month + 1);\n\n        let date = new Date(this.year, this.month - 1, 0);\n        let totalDays = date.getDate();\n        let fromWeek = date.getDay();\n        for (let i = 0; i < this.pfgListDay.length; ++i) {\n            let node = this.pfgListDay[i];\n            if (i < totalDays) {\n                node.active = true;\n                let index = fromWeek + i;\n                let row = Math.floor(index / 7);\n                let col = index % 7;\n                let x = -(this.ndDays.width - node.width) * 0.5 + col * node.width;\n                let y = (this.ndDays.height - node.height) * 0.5 - row * node.height;\n                node.setPosition(x, y);\n                let script = node.getComponent(\"UIItemDay\");\n                script.setDay(i, i + 1, this.day === i + 1, (selIndex, selDay)=>{\n                    this.day = selDay;\n                    this.updateDate();\n                });\n            } else {\n                node.active = false;\n            }\n        }\n        var month = (\"0\" + this.month).slice(-2);\n        var day = (\"0\" + this.day).slice(-2);\n        this.displayDate.string = day +\"-\" +month +\"-\"+this.year;\n        this.CurrentDayChoose = this.year+\"/\"+ month+\"/\" + day;\n        this.onClickClose();\n    },\n\n    onClickLeft () {\n        if (this.month > 0) {\n            this.month -= 1;\n        } else {\n            this.month = 11;\n            this.year -= 1;\n        }\n        this.date.setFullYear(this.year);\n        this.date.setMonth(this.month);\n        this.updateDate();\n    },\n\n    onClickRight () {\n        if (this.month < 11) {\n            this.month += 1;\n        } else {\n            this.month = 0;\n            this.year += 1;\n        }\n        this.date.setFullYear(this.year);\n        this.date.setMonth(this.month);\n        this.updateDate();\n    },\n\n    // 设置选中日期之后的回调\n    setPickDateCallback(cb) {\n        this.cb = cb;\n    },\n\n    onClickClose () {\n        if (this.cb) {\n            this.cb(this.year, this.month, this.day);\n        }\n        if(this.ChangeEvent != null)\n        {\n            this.ChangeEvent.forEach(x =>{\n                x.emit();\n            });\n           \n        }\n        this.contentShow.active = false;\n    },\n    onClickShow()\n    {\n        this.contentShow.active = true;\n    }\n});\n"]}