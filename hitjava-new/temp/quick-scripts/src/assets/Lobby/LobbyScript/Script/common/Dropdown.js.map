{"version":3,"sources":["assets\\Lobby\\LobbyScript\\Script\\common\\Dropdown.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DropdownItem from \"./DropdownItem\";\n\n// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst { ccclass, property, requireComponent } = cc._decorator;\n\n@ccclass\n@requireComponent(cc.Button)\nexport default class Dropdown extends cc.Component {\n    @property(cc.Label)\n    label: cc.Label = null;\n\n    @property(DropdownItem)\n    itemTemplate: DropdownItem = null;\n\n    private value: number = 0;\n\n    private onValueChange: (idx: number) => void;\n    private data: Array<string> = [];\n    private items: Array<DropdownItem> = [];\n\n    public start() {\n        this.itemTemplate.node.active = false;\n    }\n\n    public show() {\n        this.node.active = true;\n        this.node.opacity = 0;\n        this.node.runAction(cc.fadeIn(0.2));\n        \n        for (var i = 0; i < this.items.length; i++) {\n            this.items[i].checkMark.active = this.items[i].idx == this.value;\n        }\n    }\n\n    public setOptions(data: Array<string> = []) {\n        this.data = data;\n        var childen = this.itemTemplate.node.parent.children;\n        for (var i = 0; i < childen.length; i++) {\n            childen[i].active = false;\n        }\n        this.items = [];\n        for (var i = 0; i < data.length; i++) {\n            var item = this.getItem();\n            item.idx = i;\n            item.label.string = data[i];\n            item.checkMark.active = i == this.value;\n            this.items.push(item);\n        }\n    }\n\n    public dismiss() {\n        var _this = this;\n        this.node.runAction(cc.sequence(cc.fadeOut(0.2), cc.callFunc(() => {\n            _this.node.active = false;\n        })));\n    }\n\n    public setOnValueChange(callback: (idx: number) => void) {\n        this.onValueChange = callback;\n    }\n\n    public setValue(value: number) {\n        if (value < this.data.length) {\n            this.value = value;\n            this.label.string = this.data[this.value];\n        } else {\n            this.value = 0;\n        }\n    }\n\n    public getValue(): number {\n        return this.value;\n    }\n\n    private getItem(): DropdownItem {\n        var node: cc.Node = null;\n        var childen = this.itemTemplate.node.parent.children;\n        for (var i = 0; i < childen.length; i++) {\n            if (!childen[i].active && childen[i] != this.itemTemplate.node) node = childen[i];\n        }\n        if (node == null) {\n            node = cc.instantiate(this.itemTemplate.node);\n            node.parent = this.itemTemplate.node.parent;\n            node.on(\"click\", (target: any) => {\n                this.value = target.getComponent(DropdownItem).idx;\n                this.label.string = this.data[this.value];\n                if (this.onValueChange) this.onValueChange(this.value);\n                this.dismiss();\n            }, this);\n        }\n        node.active = true;\n        node.zIndex = this.getLastZIndex();\n        return node.getComponent(DropdownItem);\n    }\n\n    private getLastZIndex() {\n        var c = 0;\n        var childen = this.itemTemplate.node.parent.children;\n        for (var i = 1; i < childen.length; i++) {\n            if (childen[i].active) c++;\n        }\n        return c;\n    }\n}\n"]}