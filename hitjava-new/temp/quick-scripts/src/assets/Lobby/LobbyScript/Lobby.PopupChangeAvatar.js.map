{"version":3,"sources":["assets\\Lobby\\LobbyScript\\Lobby.PopupChangeAvatar.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Configs from \"../../Loading/src/Configs\";\nimport Http from \"../../Loading/src/Http\";\nimport App from \"./Script/common/App\";\nimport BroadcastReceiver from \"./Script/common/BroadcastReceiver\";\nimport Dialog from \"./Script/common/Dialog\";\nimport Utils from \"./Script/common/Utils\";\n\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class PopupChangeAvatar extends Dialog {\n    @property(cc.Node)\n    items: cc.Node = null;\n    @property(cc.Node)\n    itemTemplate: cc.Node = null;\n\n    private selectedIdx = -1;\n\n    start() {\n        for (let i = 0; i < App.instance.sprFrameAvatars.length; i++) {\n            let item = cc.instantiate(this.itemTemplate);\n            item.parent = this.items;\n            item.getChildByName(\"sprite\").getComponent(cc.Sprite).spriteFrame = App.instance.sprFrameAvatars[i];\n            item.name = App.instance.sprFrameAvatars[i].name;\n\n            item.on(\"click\", () => {\n                this.selectedIdx = i;\n                this.actSubmit();\n            });\n            this.selectedIdx = i;\n        }\n        // this.itemTemplate.removeFromParent();\n        // this.itemTemplate = null;\n    }\n\n    show() {\n         ////Utils.Log(\"vao day ha aaaa:\" + this.name);\n        super.show();\n        this.selectedIdx = -1;\n        if (this.itemTemplate == null) {\n            for (let i = 0; i < this.items.childrenCount; i++) {\n                let item = this.items.children[i];\n                if (item.name == Configs.Login.Avatar) {\n                    this.selectedIdx = i;\n                    item.getChildByName(\"selected\").active = true;\n                } else {\n                    item.getChildByName(\"selected\").active = false;\n                }\n            }\n        }\n    }\n\n    actSubmit() {\n        Http.get(Configs.App.API, { \"c\": 125, \"nn\": Configs.Login.Nickname, \"avatar\": App.instance.sprFrameAvatars[this.selectedIdx].name }, (err, res) => {\n            if (err != null) {\n                App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_error'));\n                return;\n            }\n            if (!res[\"success\"]) {\n                switch (res[\"errorCode\"]) {\n                    default:\n                        App.instance.alertDialog.showMsg(App.instance.getTextLang(\"txt_unknown_error\") + \"\\n\" + res[\"errorCode\"]);\n                        break;\n                }\n                return;\n            }\n            this.dismiss();\n            Configs.Login.Avatar = App.instance.sprFrameAvatars[this.selectedIdx].name;\n            BroadcastReceiver.send(BroadcastReceiver.USER_INFO_UPDATED);\n            App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_action_success'));\n        });\n    }\n}\n"]}