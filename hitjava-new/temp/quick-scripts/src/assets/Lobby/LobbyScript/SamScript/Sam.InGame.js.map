{"version":3,"sources":["assets\\Lobby\\LobbyScript\\SamScript\\Sam.InGame.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import SamPlayer from \"./Sam.Player\"\nimport SamNetworkClient from \"../Script/networks/SamNetworkClient\";\nimport SamCmd from \"./Sam.Cmd\";\nimport Room from \"./Sam.Room\";\nimport InGame from \"../TienLenScript/TienLenz.InGame\"\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class SamInGame extends InGame {\n\n    public static instance: SamInGame = null;\n\n    @property({\n        type: SamPlayer,\n        override: true\n    })\n    players: SamPlayer[] = [];\n\n    onLoad() {\n        SamInGame.instance = this;\n        this.initRes();\n    }\n\n    actLeaveRoom() {\n        SamNetworkClient.getInstance().send(new SamCmd.SendRequestLeaveGame());\n    }\n\n    userLeaveRoom(data) {\n        var chair = this.convertChair(data.chair);\n        this.players[chair].setLeaveRoom();\n        if (chair == 0) {\n            this.show(false);\n            Room.instance.show(true);\n            Room.instance.refreshRoom();\n        }\n    }\n\n    chiaBai(data) {\n        super.chiaBai(data);\n        this.setActiveButtons([\"bt_sam\", \"bt_huy_sam\"], [true, true]);\n        this.players.forEach(p => {\n            if (p.active)\n                p.setTimeRemain(data.timeBaoSam);\n        });\n    }\n\n    sendSubmitTurn(cardSelected) {\n        SamNetworkClient.getInstance().send(new SamCmd.SendDanhBai(!1, cardSelected));\n    }\n\n    sendPassTurn() {\n        SamNetworkClient.getInstance().send(new SamCmd.SendBoLuot(!0));\n    }\n\n    actBaoSam() {\n        SamNetworkClient.getInstance().send(new SamCmd.SendBaoSam());\n    }\n\n    actHuyBaoSam() {\n        SamNetworkClient.getInstance().send(new SamCmd.SendHuyBaoSam());\n    }\n\n    onBaoSam(data) {\n        var chair = this.convertChair(data.chair);\n        var p = this.players[chair];\n        p.setTimeRemain(0);\n        p.setStatus(\"BÁO SÂM\");\n        if (data.chair == this.myChair)\n            this.setActiveButtons([\"bt_sam\", \"bt_huy_sam\"], [false, false]);\n    }\n\n    onHuyBaoSam(data) {\n        var chair = this.convertChair(data.chair);\n        var p = this.players[chair];\n        p.setTimeRemain(0);\n        p.setStatus(\"HUỶ SÂM\");\n        if (data.chair == this.myChair)\n            this.setActiveButtons([\"bt_sam\", \"bt_huy_sam\"], [false, false]);\n    }\n\n    onQuyetDinhSam(data) {\n        this.setActiveButtons([\"bt_sam\", \"bt_huy_sam\"], [false, false]);\n        if (data.isSam) {\n            var chair = this.convertChair(data.chair);\n            var p = this.players[chair];\n            if (p.active)\n                this.showToast(p.info.nickName + \" được quyền báo sâm\");\n        }\n    }\n\n    notifyUserRegOutRoom(res) {\n        let outChair = res[\"outChair\"];\n        let isOutRoom = res[\"isOutRoom\"];\n        let chair = this.convertChair(outChair);\n        if (chair == 0) {\n            if (isOutRoom) {\n                this.players[chair].setNotify(\"Sắp rời bàn !\");\n            } else {\n                this.players[chair].setNotify(\"Khô Máu !\");\n            }\n        }\n    }\n\n    playerChat(res) {\n        let chair = res[\"chair\"];\n        let isIcon = res[\"isIcon\"];\n        let content = res[\"content\"];\n\n        let seatId = this.convertChair(chair);\n        if (isIcon) {\n            // Chat Icon\n            this.players[seatId].showChatEmotion(content);\n        } else {\n            // Chat Msg\n            this.players[seatId].showChatMsg(content);\n        }\n    }\n\n\n    playerChatChong(res) {\n        let winChair = res[\"winChair\"];\n        let lostChair = res[\"lostChair\"];\n        let winMoney = res[\"winMoney\"];\n        let lostMoney = res[\"lostMoney\"];\n        let winCurrentMoney = res[\"winCurrentMoney\"];\n        let lostCurrentMoney = res[\"lostCurrentMoney\"];\n\n        setTimeout(() => {\n            let seatIdWin = this.convertChair(winChair);\n            let seatIdLost = this.convertChair(lostChair);\n            this.players[seatIdWin].setCoinChange(winMoney);\n            this.players[seatIdLost].setCoinChange(lostMoney);\n            this.players[seatIdWin].setCoin(winCurrentMoney);\n            this.players[seatIdLost].setCoin(lostCurrentMoney);\n            setTimeout(() => {\n                this.players[seatIdWin].setStatus(\"\");\n                this.players[seatIdLost].setStatus(\"\");\n            }, 2000);\n        }, 1000);\n    }\n\n    showPopupGuide() {\n        this.popupGuide.active = true;\n    }\n\n    closePopupGuide() {\n        this.popupGuide.active = false;\n    }\n\n    // Chat\n    showUIChat() {\n        this.UI_Chat.active = true;\n        this.UI_Chat.runAction(\n            cc.moveTo(0.5, 546, 0)\n        );\n    }\n\n    closeUIChat() {\n        this.UI_Chat.runAction(\n            cc.moveTo(0.5, 1000, 0)\n        );\n    }\n\n    chatEmotion(event, id) {\n        //  cc.log(\"BaCay chatEmotion id : \", id);\n        SamNetworkClient.getInstance().send(new SamCmd.SendChatRoom(1, id));\n        this.closeUIChat();\n    }\n\n    chatMsg() {\n        if (this.edtChatInput.string.trim().length > 0) {\n            SamNetworkClient.getInstance().send(new SamCmd.SendChatRoom(0, this.edtChatInput.string));\n            this.edtChatInput.string = \"\";\n            this.closeUIChat();\n        }\n    }\n}\n"]}