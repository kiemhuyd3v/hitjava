{"version":3,"sources":["assets\\Lobby\\LobbyScript\\PopupRegister.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\nimport BundleControl from \"../../Loading/src/BundleControl\";\nimport Configs from \"../../Loading/src/Configs\";\nimport { Global } from \"../../Loading/src/Global\";\nimport Http from \"../../Loading/src/Http\";\nimport LogEvent from \"../../Loading/src/LogEvent/LogEvent\";\nimport App from \"./Script/common/App\";\nimport Dialog from \"./Script/common/Dialog\";\nimport Utils from \"./Script/common/Utils\";\n\nconst { ccclass, property } = cc._decorator;\n\nnamespace Lobby {\n\n    @ccclass\n    export class PopupRegister extends Dialog {\n\n        @property(cc.EditBox)\n        edbUsername: cc.EditBox = null;\n        @property(cc.EditBox)\n        edbCodeDaiLi: cc.EditBox = null;\n        @property(cc.EditBox)\n        edbPassword: cc.EditBox = null;\n        @property(cc.EditBox)\n        edbRePassword: cc.EditBox = null;\n        @property(cc.EditBox)\n        edbCaptcha: cc.EditBox = null;\n        @property(cc.Sprite)\n        sprCaptcha: cc.Sprite = null;\n        @property(cc.RichText)\n        txtCodeCheck: cc.RichText = null;\n        @property(cc.Button)\n        btnRegister: cc.Button = null;\n\n\n        @property(cc.Button)\n        btn_refresh: cc.Button = null;\n\n\n        private captchaId: string = \"\";\n        start() {\n            Global.PopupRegister = this;\n        }\n        show(even = null, data = null) {\n            this.txtCodeCheck.string = \"\";\n\n            super.show();\n            this.edbUsername.tabIndex = 0;\n            this.edbPassword.tabIndex = 0;\n            this.edbRePassword.tabIndex = -1;\n            this.edbCaptcha.tabIndex = -1;\n            this.edbCodeDaiLi.tabIndex = -1;\n            this.refreshCaptcha();\n            if (Configs.App.AGENCY_CODE != \"\") {\n                this.edbCodeDaiLi.string = Configs.App.AGENCY_CODE;\n                this.edbCodeDaiLi.node.getComponent(cc.EditBox).enabled = false;\n            }\n\n        }\n\n        actCheckCodeDaiLi() {\n            if (this.edbCodeDaiLi.string) {\n                var repParams = {};\n                repParams[\"c\"] = 18;\n                repParams[\"code\"] = this.edbCodeDaiLi.string;\n                Http.get(Configs.App.API, repParams, (err, res) => {\n                     //Utils.Log(\"actCheckCodeDaiLi:\" + JSON.stringify(res));\n                    if (res.success == false) {\n                        this.txtCodeCheck.string = \"<color=#FF2C23>Không hợp lệ</color>\";\n                    }\n                    else {\n                        this.txtCodeCheck.string = \"<color=#23FF23>Hợp lệ</color>\";\n                    }\n                });\n            }\n        }\n        public actRegister() {\n            let _this = this;\n            let username = this.edbUsername.string.trim();\n            let password = this.edbPassword.string;\n            let rePassword = this.edbRePassword.string;\n            let captcha = this.edbCaptcha.string;\n            if (username.length == 0) {\n                App.instance.alertDialog.showMsg(App.instance.getTextLang(\"txt_login_username_not_blank\"));\n                return;\n            }\n\n            if (password.length == 0) {\n                App.instance.alertDialog.showMsg(App.instance.getTextLang(\"txt_login_password_not_blank\"));\n                return;\n            }\n\n            if (password != rePassword) {\n                App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_password_incorrect3'));\n                return;\n            }\n\n        //    if (captcha.length == 0) {\n        //        App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_otp_blank'));\n        //        return;\n        //    }\n\n            App.instance.showLoading(true);\n            let reqParams = { \"c\": 1, \"un\": username, \"pw\": md5(password), \"cp\": captcha, \"cid\": this.captchaId, \"ac\": this.edbCodeDaiLi.string };\n            if (cc.sys.isNative && cc.sys.os == cc.sys.OS_IOS) {\n                reqParams[\"utm_source\"] = \"IOS\";\n                reqParams[\"utm_medium\"] = \"IOS\";\n                reqParams[\"utm_term\"] = \"IOS\";\n                reqParams[\"utm_content\"] = \"IOS\";\n                reqParams[\"utm_campaign\"] = \"IOS\";\n            } else if (cc.sys.isNative && cc.sys.os == cc.sys.OS_ANDROID) {\n                reqParams[\"utm_source\"] = \"ANDROID\";\n                reqParams[\"utm_medium\"] = \"ANDROID\";\n                reqParams[\"utm_term\"] = \"ANDROID\";\n                reqParams[\"utm_content\"] = \"ANDROID\";\n                reqParams[\"utm_campaign\"] = \"ANDROID\";\n            }\n            Http.get(Configs.App.API, reqParams, (err, res) => {\n                App.instance.showLoading(false);\n                if (err != null) {\n                    App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_error'));\n                    return;\n                }\n                 //Utils.Log(res);\n                if (!res[\"success\"]) {\n                    switch (parseInt(res[\"errorCode\"])) {\n                        case 1001:\n                            App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_check_connect'));\n                            _this.refreshCaptcha();\n                            break;\n                        case 101:\n                            App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_login_username_error'));\n                            _this.refreshCaptcha();\n                            break;\n                        case 1006:\n                            App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_login_account_exsisted'));\n                            _this.refreshCaptcha();\n                            break;\n                        case 102:\n                            App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_login_password_error'));\n                            _this.refreshCaptcha();\n                            break;\n                        case 108:\n                            App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_login_account_name_not_the_same1'));\n                            _this.refreshCaptcha();\n                            break;\n                        case 115:\n                            App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_login_account_incorrect_otp'));\n                            break;\n                        case 1114:\n                            App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_room_err6'));\n                            _this.refreshCaptcha();\n                            break;\n                        default:\n                            App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_error'));\n                            break;\n                    }\n                    return;\n                }\n                //  //Utils.Log(\"Dang ky thanh cong ne!\");\n                LogEvent.getInstance().sendEventSigupSuccess(\"normal\");\n                _this.dismiss();\n                _this.atcPopupUpdateNickName(username, password);\n            });\n        }\n\n        public refreshCaptcha() {\n            var _this = this;\n\n            let url = Configs.App.API;\n            Http.get(url, { \"c\": 124 }, (err, res) => {\n                if (err != null) {\n                    App.instance.alertDialog.showMsg(App.instance.getTextLang('txt_error'));\n                    return;\n                }\n                _this.captchaId = res[\"id\"];\n                 //Utils.Log(\"captcha:\" + JSON.stringify(res[\"img\"]));\n                Utils.loadSpriteFrameFromBase64(res[\"img\"], (sprFrame) => {\n                    _this.sprCaptcha.spriteFrame = sprFrame;\n                });\n            });\n        }\n        atcPopupUpdateNickName(username, password) {\n            let cb = (prefab) => {\n                let popupDaily = cc.instantiate(prefab).getComponent(\"PopupUpdateNickname\");\n                App.instance.canvas.addChild(popupDaily.node)\n                App.instance.popupUpdateNickname = popupDaily;\n                App.instance.popupUpdateNickname.show2(username, password);\n            }\n            BundleControl.loadPrefabPopup(\"PrefabPopup/PopupUpdateNickname\", cb);\n        }\n\n\n\n\n\n    }\n}\nexport default Lobby.PopupRegister;\n"]}